INFO:root:Connected to primary MongoDB.
INFO:root:Connected to backup MongoDB.
INFO:root:Synchronizing all databases on startup...
INFO:root:Checking database consistency...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Server running on SMTP port 1026 and POP3 port 1102
INFO:root:Alice's POP3 server running on port 1102
INFO:root:Alice's SMTP server running on port 1026
INFO:root:Connected to primary MongoDB.
INFO:root:Connected to backup MongoDB.
INFO:root:Synchronizing all databases on startup...
INFO:root:Checking database consistency...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Server running on SMTP port 1026 and POP3 port 1102
INFO:root:Alice's SMTP server running on port 1026
INFO:root:Alice's POP3 server running on port 1102
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Connected to primary MongoDB.
INFO:root:Connected to backup MongoDB.
INFO:root:Synchronizing all databases on startup...
INFO:root:Checking database consistency...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Server running on SMTP port 1026 and POP3 port 1102
INFO:root:Alice's SMTP server running on port 1026
INFO:root:Alice's POP3 server running on port 1102
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Raw email data received:
From: bob@example.com
To: alice@example.com
Encrypted-AES-Key: QghlAQM0PdvsyUxq0EaX0vwvm7opcJZglHjPtVJSUOh8Z7Zf6hSJlaXXFHuJzHaaaUhbONRpQmf5jdNhnbHlseHRPuvLpWPtrFvaBJxICPCPiPDzkJE3zk+Xxr8qR3WG1HSlRmBqexEN7A6yogvwz82TnarsECs1k2HKtYdKokYJkS6iw0Jc1IWgo7eo5JBdDqIhsZeB2oR+rvSMJEKRAaY88nzS4mBiUFwIngcj1W+Y3XqM54J93QJaZnSsauJ/HX4ei2RRtYAh4qPa2rMXC1vpeLV8B+h1ofA6G73zPtdMzDNPFwwsh+9DZyq889YRIEwrCpLQwJjls6T2oqGsLg==
IV: aBWw2B1dl+R2Cq/l81udeQ==
Message: TcKtNUnG+bQvkYLlEalEM5KS2jXNHU51LLF9zatvWZ4=

INFO:root:Message stored in primary database.
INFO:root:Message stored in backup database.
INFO:root:Message stored for recipients: ['alice@example.com']
INFO:root:Running periodic database synchronization...
INFO:root:2025-07-10 00:35:38.268160 | User: alice@example.com | Action: send_email | Details: To: bob@example.com
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Received POP3 request for: alice@example.com
INFO:root:Retrieved 4 messages from primary database for recipient: alice@example.com
INFO:root:Sent message to alice@example.com
INFO:root:Sent message to alice@example.com
INFO:root:Sent message to alice@example.com
INFO:root:Sent message to alice@example.com
INFO:root:Running periodic database synchronization...
INFO:root:Connected to primary MongoDB.
INFO:root:Connected to backup MongoDB.
INFO:root:Synchronizing all databases on startup...
ERROR:root:Error during synchronization: No servers match selector "Primary()", Timeout: 30s, Topology Description: <TopologyDescription id: 68700d6c03f6e48e94fcc97c, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: RSGhost, rtt: 0.0022208049518449118>]>
INFO:root:Checking database consistency...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Server running on SMTP port 1026 and POP3 port 1102
INFO:root:Alice's POP3 server running on port 1102
INFO:root:Alice's SMTP server running on port 1026
ERROR:root:Error enforcing retention policy: No servers match selector "Primary()", Timeout: 30s, Topology Description: <TopologyDescription id: 68700d6c03f6e48e94fcc97c, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: RSGhost, rtt: 0.011530467887437145>]>
ERROR:root:Error during synchronization: No servers match selector "Primary()", Timeout: 30s, Topology Description: <TopologyDescription id: 68700d6c03f6e48e94fcc97c, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: RSGhost, rtt: 0.011530467887437145>]>
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
ERROR:root:Error during synchronization: Could not reach any servers in [('452b90da3286', 27017)]. Replica set is configured with internal hostnames or IPs?, Timeout: 30s, Topology Description: <TopologyDescription id: 68700d6c03f6e48e94fcc97c, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('452b90da3286', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('452b90da3286:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
INFO:root:Connected to primary MongoDB.
INFO:root:Connected to backup MongoDB.
INFO:root:Synchronizing all databases on startup...
ERROR:root:Error during synchronization: Could not reach any servers in [('452b90da3286', 27017)]. Replica set is configured with internal hostnames or IPs?, Timeout: 30s, Topology Description: <TopologyDescription id: 68700e073d13247e09b299fe, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('452b90da3286', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('452b90da3286:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
INFO:root:Checking database consistency...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Server running on SMTP port 1026 and POP3 port 1102
INFO:root:Alice's POP3 server running on port 1102
INFO:root:Alice's SMTP server running on port 1026
ERROR:root:Error enforcing retention policy: Could not reach any servers in [('452b90da3286', 27017)]. Replica set is configured with internal hostnames or IPs?, Timeout: 30s, Topology Description: <TopologyDescription id: 68700e073d13247e09b299fe, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('452b90da3286', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('452b90da3286:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Error during synchronization: Could not reach any servers in [('452b90da3286', 27017)]. Replica set is configured with internal hostnames or IPs?, Timeout: 30s, Topology Description: <TopologyDescription id: 68700e073d13247e09b299fe, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('452b90da3286', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('452b90da3286:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
ERROR:root:Error during synchronization: Could not reach any servers in [('452b90da3286', 27017)]. Replica set is configured with internal hostnames or IPs?, Timeout: 30s, Topology Description: <TopologyDescription id: 68700e073d13247e09b299fe, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('452b90da3286', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('452b90da3286:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
INFO:root:Running periodic database synchronization...
ERROR:root:Error enforcing retention policy: Could not reach any servers in [('452b90da3286', 27017)]. Replica set is configured with internal hostnames or IPs?, Timeout: 30s, Topology Description: <TopologyDescription id: 68700e073d13247e09b299fe, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('452b90da3286', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('452b90da3286:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Error during synchronization: Could not reach any servers in [('452b90da3286', 27017)]. Replica set is configured with internal hostnames or IPs?, Timeout: 30s, Topology Description: <TopologyDescription id: 68700e073d13247e09b299fe, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('452b90da3286', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('452b90da3286:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
ERROR:root:Error during synchronization: Could not reach any servers in [('452b90da3286', 27017)]. Replica set is configured with internal hostnames or IPs?, Timeout: 30s, Topology Description: <TopologyDescription id: 68700e073d13247e09b299fe, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('452b90da3286', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('452b90da3286:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Error enforcing retention policy: Could not reach any servers in [('452b90da3286', 27017)]. Replica set is configured with internal hostnames or IPs?, Timeout: 30s, Topology Description: <TopologyDescription id: 68700e073d13247e09b299fe, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('452b90da3286', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('452b90da3286:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
ERROR:root:Error during synchronization: Could not reach any servers in [('452b90da3286', 27017)]. Replica set is configured with internal hostnames or IPs?, Timeout: 30s, Topology Description: <TopologyDescription id: 68700e073d13247e09b299fe, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('452b90da3286', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('452b90da3286:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
INFO:root:Running periodic database synchronization...
ERROR:root:Error enforcing retention policy: Could not reach any servers in [('452b90da3286', 27017)]. Replica set is configured with internal hostnames or IPs?, Timeout: 30s, Topology Description: <TopologyDescription id: 68700e073d13247e09b299fe, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('452b90da3286', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('452b90da3286:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Error during synchronization: Could not reach any servers in [('452b90da3286', 27017)]. Replica set is configured with internal hostnames or IPs?, Timeout: 30s, Topology Description: <TopologyDescription id: 68700e073d13247e09b299fe, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('452b90da3286', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('452b90da3286:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
ERROR:root:Error enforcing retention policy: Could not reach any servers in [('452b90da3286', 27017)]. Replica set is configured with internal hostnames or IPs?, Timeout: 30s, Topology Description: <TopologyDescription id: 68700e073d13247e09b299fe, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('452b90da3286', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('452b90da3286:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Error during synchronization: Could not reach any servers in [('452b90da3286', 27017)]. Replica set is configured with internal hostnames or IPs?, Timeout: 30s, Topology Description: <TopologyDescription id: 68700e073d13247e09b299fe, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('452b90da3286', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('452b90da3286:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
ERROR:root:Error during synchronization: Could not reach any servers in [('452b90da3286', 27017)]. Replica set is configured with internal hostnames or IPs?, Timeout: 30s, Topology Description: <TopologyDescription id: 68700e073d13247e09b299fe, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('452b90da3286', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('452b90da3286:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
INFO:root:Running periodic database synchronization...
ERROR:root:Error enforcing retention policy: Could not reach any servers in [('452b90da3286', 27017)]. Replica set is configured with internal hostnames or IPs?, Timeout: 30s, Topology Description: <TopologyDescription id: 68700e073d13247e09b299fe, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('452b90da3286', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('452b90da3286:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Error during synchronization: Could not reach any servers in [('452b90da3286', 27017)]. Replica set is configured with internal hostnames or IPs?, Timeout: 30s, Topology Description: <TopologyDescription id: 68700e073d13247e09b299fe, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('452b90da3286', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('452b90da3286:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
INFO:root:Connected to primary MongoDB.
INFO:root:Connected to backup MongoDB.
INFO:root:Synchronizing all databases on startup...
ERROR:root:Error during synchronization: Could not reach any servers in [('452b90da3286', 27017)]. Replica set is configured with internal hostnames or IPs?, Timeout: 30s, Topology Description: <TopologyDescription id: 68701047ca81ff813013c8e4, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('452b90da3286', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('452b90da3286:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
INFO:root:Checking database consistency...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Server running on SMTP port 1026 and POP3 port 1102
INFO:root:Alice's POP3 server running on port 1102
INFO:root:Alice's SMTP server running on port 1026
ERROR:root:Error enforcing retention policy: Could not reach any servers in [('452b90da3286', 27017)]. Replica set is configured with internal hostnames or IPs?, Timeout: 30s, Topology Description: <TopologyDescription id: 68701047ca81ff813013c8e4, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('452b90da3286', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('452b90da3286:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Error during synchronization: Could not reach any servers in [('452b90da3286', 27017)]. Replica set is configured with internal hostnames or IPs?, Timeout: 30s, Topology Description: <TopologyDescription id: 68701047ca81ff813013c8e4, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('452b90da3286', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('452b90da3286:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
ERROR:root:Error during synchronization: Could not reach any servers in [('452b90da3286', 27017)]. Replica set is configured with internal hostnames or IPs?, Timeout: 30s, Topology Description: <TopologyDescription id: 68701047ca81ff813013c8e4, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('452b90da3286', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('452b90da3286:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
INFO:root:Running periodic database synchronization...
ERROR:root:Error enforcing retention policy: Could not reach any servers in [('452b90da3286', 27017)]. Replica set is configured with internal hostnames or IPs?, Timeout: 30s, Topology Description: <TopologyDescription id: 68701047ca81ff813013c8e4, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('452b90da3286', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('452b90da3286:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Error during synchronization: Could not reach any servers in [('452b90da3286', 27017)]. Replica set is configured with internal hostnames or IPs?, Timeout: 30s, Topology Description: <TopologyDescription id: 68701047ca81ff813013c8e4, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('452b90da3286', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('452b90da3286:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
ERROR:root:Error enforcing retention policy: Could not reach any servers in [('452b90da3286', 27017)]. Replica set is configured with internal hostnames or IPs?, Timeout: 30s, Topology Description: <TopologyDescription id: 68701047ca81ff813013c8e4, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('452b90da3286', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('452b90da3286:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Error during synchronization: Could not reach any servers in [('452b90da3286', 27017)]. Replica set is configured with internal hostnames or IPs?, Timeout: 30s, Topology Description: <TopologyDescription id: 68701047ca81ff813013c8e4, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('452b90da3286', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('452b90da3286:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
ERROR:root:Error during synchronization: Could not reach any servers in [('452b90da3286', 27017)]. Replica set is configured with internal hostnames or IPs?, Timeout: 30s, Topology Description: <TopologyDescription id: 68701047ca81ff813013c8e4, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('452b90da3286', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('452b90da3286:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
INFO:root:Running periodic database synchronization...
ERROR:root:Error enforcing retention policy: Could not reach any servers in [('452b90da3286', 27017)]. Replica set is configured with internal hostnames or IPs?, Timeout: 30s, Topology Description: <TopologyDescription id: 68701047ca81ff813013c8e4, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('452b90da3286', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('452b90da3286:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Error during synchronization: Could not reach any servers in [('452b90da3286', 27017)]. Replica set is configured with internal hostnames or IPs?, Timeout: 30s, Topology Description: <TopologyDescription id: 68701047ca81ff813013c8e4, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('452b90da3286', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('452b90da3286:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
ERROR:root:Error enforcing retention policy: Could not reach any servers in [('452b90da3286', 27017)]. Replica set is configured with internal hostnames or IPs?, Timeout: 30s, Topology Description: <TopologyDescription id: 68701047ca81ff813013c8e4, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('452b90da3286', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('452b90da3286:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Error during synchronization: Could not reach any servers in [('452b90da3286', 27017)]. Replica set is configured with internal hostnames or IPs?, Timeout: 30s, Topology Description: <TopologyDescription id: 68701047ca81ff813013c8e4, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('452b90da3286', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('452b90da3286:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
ERROR:root:Error during synchronization: Could not reach any servers in [('452b90da3286', 27017)]. Replica set is configured with internal hostnames or IPs?, Timeout: 30s, Topology Description: <TopologyDescription id: 68701047ca81ff813013c8e4, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('452b90da3286', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('452b90da3286:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
INFO:root:Running periodic database synchronization...
ERROR:root:Error enforcing retention policy: Could not reach any servers in [('452b90da3286', 27017)]. Replica set is configured with internal hostnames or IPs?, Timeout: 30s, Topology Description: <TopologyDescription id: 68701047ca81ff813013c8e4, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('452b90da3286', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('452b90da3286:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
INFO:root:Connected to primary MongoDB.
INFO:root:Connected to backup MongoDB.
INFO:root:Synchronizing all databases on startup...
ERROR:root:Error during synchronization: No servers match selector "Primary()", Timeout: 30s, Topology Description: <TopologyDescription id: 6870125822e9b7b1a8b4ba65, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: RSGhost, rtt: 0.002403389287806931>]>
INFO:root:Checking database consistency...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Server running on SMTP port 1026 and POP3 port 1102
INFO:root:Alice's SMTP server running on port 1026
INFO:root:Alice's POP3 server running on port 1102
ERROR:root:Error during synchronization: No servers match selector "Primary()", Timeout: 30s, Topology Description: <TopologyDescription id: 6870125822e9b7b1a8b4ba65, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: RSGhost, rtt: 0.009187117787332857>]>
ERROR:root:Error enforcing retention policy: No servers match selector "Primary()", Timeout: 30s, Topology Description: <TopologyDescription id: 6870125822e9b7b1a8b4ba65, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: RSGhost, rtt: 0.009187117787332857>]>
INFO:root:2025-07-10 19:20:56.752610 | User: alice@example.com | Action: send_email | Details: To: bob@example.com
INFO:root:Raw email data received:
From: alice@example.com
To: bob@example.com
Encrypted-AES-Key: bu3n41Mg2VjhJEYhMUiuwYRbDoeNtp9mvTBGcys2NQUcDsc3N+mz4grzW/YCC++M6MrQAZ1Oitl9eVMb51MSUiDSNEMGrQOHG0HwljsN1wk2JYLnjoxNrVgQmadPIWYeqmyKzTMWUTZ2QLl696ylo4KT2GThm4pPiay8se8k/NUAfsPIAntKSiohC/Tk3xPe70K7BnuU1ZdTxeVhfJ0AdZDgS6cXohF6Gmz/kEf/l4BZClPmfwpDBBDtzi8wfxzUWLj1hvGpwXKEuXj1ARl/IB/D2+LJUOmCfxzeaB9oJWxIILDNwdF/MaEqmkAWflMicWcUMBofdGaaCNf6cJHI9Q==
IV: m4Ow1emaw9A+zIehquUO1Q==
Message: dQBgVicySzgr9rrlGeE3O0/lSCyWMSbbfIJgXyWXU68=

INFO:root:Running periodic database synchronization...
ERROR:root:Database health check failed: No servers match selector "Primary()", Timeout: 30s, Topology Description: <TopologyDescription id: 6870125822e9b7b1a8b4ba65, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: RSGhost, rtt: 0.014011539682752427>]>
WARNING:root:primary database is not available. Skipping write.
INFO:root:Enforcing retention policy...
ERROR:root:Error during synchronization: No servers match selector "Primary()", Timeout: 30s, Topology Description: <TopologyDescription id: 6870125822e9b7b1a8b4ba65, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: RSGhost, rtt: 0.015232699565784375>]>
ERROR:root:Database health check failed: localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 6870125822e9b7b1a8b4ba66, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27018) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:backup database is not available. Skipping write.
INFO:root:Running periodic database synchronization...
ERROR:root:Error enforcing retention policy: No servers match selector "Primary()", Timeout: 30s, Topology Description: <TopologyDescription id: 6870125822e9b7b1a8b4ba65, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: RSGhost, rtt: 0.015082278057641046>]>
ERROR:root:Error during synchronization: No servers match selector "Primary()", Timeout: 30s, Topology Description: <TopologyDescription id: 6870125822e9b7b1a8b4ba65, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: RSGhost, rtt: 0.015082278057641046>]>
ERROR:root:Error handling SMTP client: [SYS] unknown error (_ssl.c:2427)
INFO:root:Connected to primary MongoDB.
INFO:root:Connected to backup MongoDB.
INFO:root:Synchronizing all databases on startup...
ERROR:root:Error during synchronization: No servers match selector "Primary()", Timeout: 30s, Topology Description: <TopologyDescription id: 68701302366e53f1ae1cec3f, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: RSGhost, rtt: 0.0014839902958483438>]>
INFO:root:Checking database consistency...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Server running on SMTP port 1026 and POP3 port 1102
INFO:root:Alice's POP3 server running on port 1102
INFO:root:Alice's SMTP server running on port 1026
INFO:root:Connected to primary MongoDB.
INFO:root:Connected to backup MongoDB.
INFO:root:Synchronizing all databases on startup...
ERROR:root:Error during synchronization: No servers match selector "Primary()", Timeout: 30s, Topology Description: <TopologyDescription id: 68701349f57022d21cf1ba16, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: RSGhost, rtt: 0.0018998669362918009>]>
INFO:root:Checking database consistency...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Server running on SMTP port 1026 and POP3 port 1102
INFO:root:Alice's POP3 server running on port 1102
INFO:root:Alice's SMTP server running on port 1026
ERROR:root:Error during synchronization: No servers match selector "Primary()", Timeout: 30s, Topology Description: <TopologyDescription id: 68701349f57022d21cf1ba16, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: RSGhost, rtt: 0.007990190639273498>]>
ERROR:root:Error enforcing retention policy: No servers match selector "Primary()", Timeout: 30s, Topology Description: <TopologyDescription id: 68701349f57022d21cf1ba16, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: RSGhost, rtt: 0.007990190639273498>]>
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
ERROR:root:Error during synchronization: No servers match selector "Primary()", Timeout: 30s, Topology Description: <TopologyDescription id: 68701349f57022d21cf1ba16, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: RSGhost, rtt: 0.013949186465438655>]>
INFO:root:Running periodic database synchronization...
ERROR:root:Error enforcing retention policy: No servers match selector "Primary()", Timeout: 30s, Topology Description: <TopologyDescription id: 68701349f57022d21cf1ba16, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: RSGhost, rtt: 0.018672285502434435>]>
ERROR:root:Error during synchronization: No servers match selector "Primary()", Timeout: 30s, Topology Description: <TopologyDescription id: 68701349f57022d21cf1ba16, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: RSGhost, rtt: 0.01827592075317162>]>
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
ERROR:root:Error enforcing retention policy: No servers match selector "Primary()", Timeout: 30s, Topology Description: <TopologyDescription id: 68701349f57022d21cf1ba16, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: RSGhost, rtt: 0.018986078485523146>]>
ERROR:root:Error during synchronization: No servers match selector "Primary()", Timeout: 30s, Topology Description: <TopologyDescription id: 68701349f57022d21cf1ba16, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: RSGhost, rtt: 0.018986078485523146>]>
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
ERROR:root:Error during synchronization: No servers match selector "Primary()", Timeout: 30s, Topology Description: <TopologyDescription id: 68701349f57022d21cf1ba16, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: RSGhost, rtt: 0.017769647090288873>]>
INFO:root:Running periodic database synchronization...
ERROR:root:Error enforcing retention policy: No servers match selector "Primary()", Timeout: 30s, Topology Description: <TopologyDescription id: 68701349f57022d21cf1ba16, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: RSGhost, rtt: 0.02528719143030983>]>
ERROR:root:Error during synchronization: No servers match selector "Primary()", Timeout: 30s, Topology Description: <TopologyDescription id: 68701349f57022d21cf1ba16, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: RSGhost, rtt: 0.02734882298840305>]>
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
ERROR:root:Error during synchronization: No servers match selector "Primary()", Timeout: 30s, Topology Description: <TopologyDescription id: 68701349f57022d21cf1ba16, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: RSGhost, rtt: 0.01989033196050279>]>
ERROR:root:Error enforcing retention policy: No servers match selector "Primary()", Timeout: 30s, Topology Description: <TopologyDescription id: 68701349f57022d21cf1ba16, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: RSGhost, rtt: 0.01989033196050279>]>
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
ERROR:root:Error during synchronization: No servers match selector "Primary()", Timeout: 30s, Topology Description: <TopologyDescription id: 68701349f57022d21cf1ba16, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: RSGhost, rtt: 0.017907538488447658>]>
INFO:root:Running periodic database synchronization...
ERROR:root:Error enforcing retention policy: No servers match selector "Primary()", Timeout: 30s, Topology Description: <TopologyDescription id: 68701349f57022d21cf1ba16, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: RSGhost, rtt: 0.021477320146392198>]>
ERROR:root:Error during synchronization: No servers match selector "Primary()", Timeout: 30s, Topology Description: <TopologyDescription id: 68701349f57022d21cf1ba16, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: RSGhost, rtt: 0.017923685090843806>]>
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
ERROR:root:Error during synchronization: No servers match selector "Primary()", Timeout: 30s, Topology Description: <TopologyDescription id: 68701349f57022d21cf1ba16, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: RSGhost, rtt: 0.01879721456766864>]>
ERROR:root:Error enforcing retention policy: No servers match selector "Primary()", Timeout: 30s, Topology Description: <TopologyDescription id: 68701349f57022d21cf1ba16, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: RSGhost, rtt: 0.01879721456766864>]>
INFO:root:Running periodic database synchronization...
ERROR:root:Error during synchronization: No servers match selector "Primary()", Timeout: 30s, Topology Description: <TopologyDescription id: 68701349f57022d21cf1ba16, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: RSGhost, rtt: 0.018895335661804992>]>
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
ERROR:root:Error enforcing retention policy: No servers match selector "Primary()", Timeout: 30s, Topology Description: <TopologyDescription id: 68701349f57022d21cf1ba16, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: RSGhost, rtt: 0.013869013819382577>]>
ERROR:root:Error during synchronization: No servers match selector "Primary()", Timeout: 30s, Topology Description: <TopologyDescription id: 68701349f57022d21cf1ba16, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: RSGhost, rtt: 0.01381151967531055>]>
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
ERROR:root:Error enforcing retention policy: No servers match selector "Primary()", Timeout: 30s, Topology Description: <TopologyDescription id: 68701349f57022d21cf1ba16, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: RSGhost, rtt: 0.020532883747867086>]>
ERROR:root:Error during synchronization: No servers match selector "Primary()", Timeout: 30s, Topology Description: <TopologyDescription id: 68701349f57022d21cf1ba16, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: RSGhost, rtt: 0.020532883747867086>]>
INFO:root:Connected to primary MongoDB.
INFO:root:Connected to backup MongoDB.
INFO:root:Synchronizing all databases on startup...
ERROR:root:Error during synchronization: localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687018f4c02b56796d71efc3, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27018) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
INFO:root:Checking database consistency...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Server running on SMTP port 1026 and POP3 port 1102
INFO:root:Alice's SMTP server running on port 1026
INFO:root:Alice's POP3 server running on port 1102
INFO:root:2025-07-10 19:48:46.459425 | User: alice@example.com | Action: send_email | Details: To: bob@example.com
INFO:root:Raw email data received:
From: alice@example.com
To: bob@example.com
Encrypted-AES-Key: OsYPwHETFDyeZNqhB0guAT9ORe9Xsq2Y4LG/D9N4l/JvgLPSSKoCua13vdkijFPOzCvN0WdT6NJawd/XWLhlvvYPEkzwqINx2v17QKHnc9ku1J2+Bg11Lc6TROx56Q3aulsML7mcvUyTREiRCgmbSdSGwiC5A+c228jeoiua9o1LzhE5Y8VV8xEsILoLNo3DKHj/bwCTVOPol3ljTQ/Lsm8OM8pOPZAXZu1mQs6HWxBFEJv9ycowRk0Qv7PPrCm8lwrld4cDbA/tG0fcbVlYRmcmZu+boWtOd6kb6jkNNSVJ+vaYy0p6YH22rLQMEHLBxh2T1ouEiI4wo8TtRMoiJQ==
IV: bwqvC6fdf1p2SLmI5LgIjw==
Message: vgRpraDeLe/SZdeXZJMLNjpOCamYta28Vzp3WZcjGeo=

INFO:root:Message stored in primary database.
ERROR:root:Error during synchronization: localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687018f4c02b56796d71efc3, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27018) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Error enforcing retention policy: localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687018f4c02b56796d71efc3, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27018) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Database health check failed: localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687018f4c02b56796d71efc3, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27018) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:backup database is not available. Skipping write.
INFO:root:Connected to primary MongoDB.
INFO:root:Connected to backup MongoDB.
INFO:root:Synchronizing all databases on startup...
ERROR:root:Error during synchronization: localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687019477dec7faf28b246a9, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27018) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
INFO:root:Checking database consistency...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Server running on SMTP port 1026 and POP3 port 1102
INFO:root:Alice's SMTP server running on port 1026
INFO:root:Alice's POP3 server running on port 1102
INFO:root:Raw email data received:
From: bob@example.com
To: alice@example.com
Encrypted-AES-Key: QdCGy00XjLcigVR+tcTk889nm9W3mIRNvb9k6GvHbf4Zsa7iK6qO8qiXaZhkelaOOETmqPa1AzHtzQjYQtoXhKN4Tp2rvVBTW1QI1FH56JEP0VH5rT/CZ/em6H6XTAbazIJJtIE838dL+4zDfC2KKKYH3yKUtFCH2KM3+5A2hPvJzDhQ1cNY+KGPp0xkty3YCXq/lTlxjFZA0QI5XXMVLZB5vH34uDmbHZBjjyx9ETGlCAz+SiFj+A8RXcS+YaXzeBX7/eY8bL0cqDQmDKZ/PbrzfKDOU7vWEiqHrArC85URcJX9USt3KHyu3jGMFPeNrStyC1+cgsfiJWCqLjHCSQ==
IV: 64s6UQd6lt976x1YFOqUDA==
Message: jfgb8UT7imKpB80uvw2PLOm4hFa8RlccdNvF6qUfGsk=

INFO:root:Message stored in primary database.
ERROR:root:Error during synchronization: localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687019477dec7faf28b246a9, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27018) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Error enforcing retention policy: localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687019477dec7faf28b246a9, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27018) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Database health check failed: localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687019477dec7faf28b246a9, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27018) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:backup database is not available. Skipping write.
INFO:root:Running periodic database synchronization...
INFO:root:Received POP3 request for: alice@example.com
INFO:root:Retrieved 2 messages from primary database for recipient: alice@example.com
INFO:root:Sent message to alice@example.com
INFO:root:Sent message to alice@example.com
ERROR:root:Error during synchronization: localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687019477dec7faf28b246a9, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27018) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Error handling SMTP client: [SYS] unknown error (_ssl.c:2427)
INFO:root:Enforcing retention policy...
ERROR:root:Error during synchronization: localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687019477dec7faf28b246a9, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27018) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Error enforcing retention policy: localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687019477dec7faf28b246a9, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27018) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
INFO:root:Running periodic database synchronization...
ERROR:root:Error during synchronization: localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687019477dec7faf28b246a9, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27018) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
ERROR:root:Error enforcing retention policy: localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687019477dec7faf28b246a9, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27018) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Error during synchronization: localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687019477dec7faf28b246a9, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27018) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
INFO:root:Running periodic database synchronization...
INFO:root:Email 6870197c7dec7faf28b246aa soft deleted in primary database.
INFO:root:Enforcing retention policy...
ERROR:root:Error during synchronization: localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687019477dec7faf28b246a9, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27018) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Error soft deleting email: localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687019477dec7faf28b246a9, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27018) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
INFO:root:Connected to primary MongoDB.
INFO:root:Connected to backup MongoDB.
INFO:root:Synchronizing all databases on startup...
ERROR:root:Error during synchronization: Could not reach any servers in [('326b4d221128', 27017)]. Replica set is configured with internal hostnames or IPs?, Timeout: 30s, Topology Description: <TopologyDescription id: 687052e06e7dbc86731b7526, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('326b4d221128', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('326b4d221128:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
INFO:root:Checking database consistency...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Server running on SMTP port 1026 and POP3 port 1102
INFO:root:Alice's SMTP server running on port 1026
INFO:root:Alice's POP3 server running on port 1102
INFO:root:2025-07-10 23:56:10.628681 | User: alice@example.com | Action: send_email | Details: To: bob@example.com
ERROR:root:Error during synchronization: Could not reach any servers in [('326b4d221128', 27017)]. Replica set is configured with internal hostnames or IPs?, Timeout: 30s, Topology Description: <TopologyDescription id: 687052e06e7dbc86731b7526, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('326b4d221128', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('326b4d221128:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Error enforcing retention policy: Could not reach any servers in [('326b4d221128', 27017)]. Replica set is configured with internal hostnames or IPs?, Timeout: 30s, Topology Description: <TopologyDescription id: 687052e06e7dbc86731b7526, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('326b4d221128', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('326b4d221128:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
INFO:root:Raw email data received:
From: bob@example.com
To: alice@example.com
Encrypted-AES-Key: tK9P2C9HujQ5NdY3tz+tAVHD0e+b6SzUGVn6nbUPiw17aDgst+a3XpZfE6MCHeB2UOsZVJKqbEKUBT1NzEINGAYJ/Tl3OXQk5G+2eFMeJb8lH7270gD7qisOZpyn7v/WTdw40dfZKBhj3/yZI47/uaGFRRJc0mSXCZx9phWtBQKTi+pdTdIHZWQLB4DjlWpWLSdeEZmgJeh1ncMtXFToNuCO39fjRth0jYllmBTJ8dPAYSijlPHwX92K9wIktcUz1OPcUZFkSfR0qi9avypFLO/wHJie2OESbi7pZDRnheoOkssZ+1YmcdcRIHs6+jzvcWqfM7r67UwFjv/JDVdAYQ==
IV: an0gb8d6VzXGR0qqpKV6pA==
Message: qN2NPrw8qXDCPDZkkH0py8C3nipWzKyow+5JiL2WG58=

INFO:root:Running periodic database synchronization...
ERROR:root:Database health check failed: Could not reach any servers in [('326b4d221128', 27017)]. Replica set is configured with internal hostnames or IPs?, Timeout: 30s, Topology Description: <TopologyDescription id: 687052e06e7dbc86731b7526, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('326b4d221128', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('326b4d221128:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:primary database is not available. Skipping write.
INFO:root:Enforcing retention policy...
ERROR:root:Error during synchronization: Could not reach any servers in [('326b4d221128', 27017)]. Replica set is configured with internal hostnames or IPs?, Timeout: 30s, Topology Description: <TopologyDescription id: 687052e06e7dbc86731b7526, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('326b4d221128', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('326b4d221128:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Database health check failed: localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687052e06e7dbc86731b7527, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27018) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:backup database is not available. Skipping write.
INFO:root:Running periodic database synchronization...
ERROR:root:Error enforcing retention policy: Could not reach any servers in [('326b4d221128', 27017)]. Replica set is configured with internal hostnames or IPs?, Timeout: 30s, Topology Description: <TopologyDescription id: 687052e06e7dbc86731b7526, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('326b4d221128', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('326b4d221128:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Error during synchronization: Could not reach any servers in [('326b4d221128', 27017)]. Replica set is configured with internal hostnames or IPs?, Timeout: 30s, Topology Description: <TopologyDescription id: 687052e06e7dbc86731b7526, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('326b4d221128', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('326b4d221128:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Error handling SMTP client: [SYS] unknown error (_ssl.c:2427)
ERROR:root:Error during synchronization: Could not reach any servers in [('326b4d221128', 27017)]. Replica set is configured with internal hostnames or IPs?, Timeout: 30s, Topology Description: <TopologyDescription id: 687052e06e7dbc86731b7526, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('326b4d221128', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('326b4d221128:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
INFO:root:Received POP3 request for: bob@example.com
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
ERROR:root:Database health check failed: Could not reach any servers in [('326b4d221128', 27017)]. Replica set is configured with internal hostnames or IPs?, Timeout: 30s, Topology Description: <TopologyDescription id: 687052e06e7dbc86731b7526, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('326b4d221128', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('326b4d221128:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Error during synchronization: Could not reach any servers in [('326b4d221128', 27017)]. Replica set is configured with internal hostnames or IPs?, Timeout: 30s, Topology Description: <TopologyDescription id: 687052e06e7dbc86731b7526, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('326b4d221128', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('326b4d221128:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Error enforcing retention policy: Could not reach any servers in [('326b4d221128', 27017)]. Replica set is configured with internal hostnames or IPs?, Timeout: 30s, Topology Description: <TopologyDescription id: 687052e06e7dbc86731b7526, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('326b4d221128', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('326b4d221128:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Error retrieving messages from backup database: localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687052e06e7dbc86731b7527, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27018) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:No messages found for recipient: bob@example.com
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
ERROR:root:Error during synchronization: Could not reach any servers in [('326b4d221128', 27017)]. Replica set is configured with internal hostnames or IPs?, Timeout: 30s, Topology Description: <TopologyDescription id: 687052e06e7dbc86731b7526, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('326b4d221128', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('326b4d221128:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
INFO:root:Running periodic database synchronization...
ERROR:root:Error enforcing retention policy: Could not reach any servers in [('326b4d221128', 27017)]. Replica set is configured with internal hostnames or IPs?, Timeout: 30s, Topology Description: <TopologyDescription id: 687052e06e7dbc86731b7526, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('326b4d221128', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('326b4d221128:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Error during synchronization: Could not reach any servers in [('326b4d221128', 27017)]. Replica set is configured with internal hostnames or IPs?, Timeout: 30s, Topology Description: <TopologyDescription id: 687052e06e7dbc86731b7526, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('326b4d221128', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('326b4d221128:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
ERROR:root:Error during synchronization: Could not reach any servers in [('326b4d221128', 27017)]. Replica set is configured with internal hostnames or IPs?, Timeout: 30s, Topology Description: <TopologyDescription id: 687052e06e7dbc86731b7526, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('326b4d221128', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('326b4d221128:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Error enforcing retention policy: Could not reach any servers in [('326b4d221128', 27017)]. Replica set is configured with internal hostnames or IPs?, Timeout: 30s, Topology Description: <TopologyDescription id: 687052e06e7dbc86731b7526, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('326b4d221128', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('326b4d221128:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
INFO:root:Running periodic database synchronization...
INFO:root:2025-07-11 00:02:47.492905 | User: alice@example.com | Action: send_email | Details: To: bob@example.com
INFO:root:Raw email data received:
From: bob@example.com
To: alice@example.com
Encrypted-AES-Key: Acl9lLfMRVkHtUVJP6Ibc6kO4x3gxiMamXVxmdshw2pRprviPQ+0QlDIYNO3qU01/xLHCrF/SVTRICNIgXMUAd+Szrj7nMGV0K0IdI++Bh0a9U5qWDIvYJP9z9IH2HdXuacGfPU+tJw4PHUwe6wYGZGGuMTkcQKagiq8JfR0tes8Do5bS1SM9paV4Lz4ow2cBRXA11lr/Yhd+bAa/SWJHrdedfmjq2RQbXE24j4KMGUpjs6Hw05yBzpTU+yuLkM2wqZRKko+R33wO5PkUgMakXVdP/rg7OBwMDDbnfEtYPXEOCtZ6eGRxJHNNnZoEQyQ5CB7Z3gZH3XH/J5NZiXNig==
IV: AUuSeAyz/z5TtrZ7bVbHzA==
Message: EtwB6ITvrCcr/ieTGekEEsgzOEqiJk9/b6pslVuwnao=

INFO:root:Enforcing retention policy...
ERROR:root:Error during synchronization: Could not reach any servers in [('326b4d221128', 27017)]. Replica set is configured with internal hostnames or IPs?, Timeout: 30s, Topology Description: <TopologyDescription id: 687052e06e7dbc86731b7526, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('326b4d221128', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('326b4d221128:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
INFO:root:Connected to primary MongoDB.
INFO:root:Connected to backup MongoDB.
INFO:root:Synchronizing all databases on startup...
INFO:root:2025-07-11 00:10:58.729024 | User: alice@example.com | Action: send_email | Details: To: bob@example.com
INFO:root:2025-07-11 00:11:03.392984 | User: alice@example.com | Action: send_email | Details: To: bob@example.com
ERROR:root:Error during synchronization: localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 6870567a73f782119f4c0339, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27018) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
INFO:root:Checking database consistency...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Server running on SMTP port 1026 and POP3 port 1102
INFO:root:Alice's POP3 server running on port 1102
INFO:root:Alice's SMTP server running on port 1026
INFO:root:Raw email data received:
From: bob@example.com
To: alice@example.com
Encrypted-AES-Key: kebxmWGLhsY9mzJplskwp8hWQ7x614YdkSuO292qDL9E5RotUBTAhFX4ilprGt3pyftUEUvISaIPhVGNWBJkw5KhYkt/TZlyO2aZQVD6/ebEui8b/Vapvv73RrgEhBNcbk8QUbdyUYjOd7grdOC09zO8deNWuSxsF84sTh9mNq/RQqgct7Dm8Iz+hOqA/xhPj/i6RvfNKtFuaenH5He1qw8NE36budLKAFAX73MwNWuLvtrAvaWl2PxR69HmzqNojb4XQhkaqJbw20e3K9j+NfhIYZQMv9Gd5G4QzybA4ZS5aTGQSfH99c2mrdut8XE3ZpTYQ1hTnFas1vukLYBrUw==
IV: i4bVzhYZ2y2ysyriGrsZ2g==
Message: DD4hzhCfLAgNpILnNfb2Gi4zzJXVHoba7q08tssiNlE=

INFO:root:Message stored in primary database.
INFO:root:Received POP3 request for: bob@example.com
INFO:root:Retrieved 1 messages from primary database for recipient: bob@example.com
INFO:root:Sent message to bob@example.com
ERROR:root:Error during synchronization: localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 6870567a73f782119f4c0339, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27018) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Error enforcing retention policy: localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 6870567a73f782119f4c0339, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27018) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Database health check failed: localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 6870567a73f782119f4c0339, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27018) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:backup database is not available. Skipping write.
INFO:root:Running periodic database synchronization...
ERROR:root:Error during synchronization: localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 6870567a73f782119f4c0339, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27018) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Error handling SMTP client: [SYS] unknown error (_ssl.c:2427)
INFO:root:Enforcing retention policy...
ERROR:root:Error during synchronization: localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 6870567a73f782119f4c0339, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27018) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Error enforcing retention policy: localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 6870567a73f782119f4c0339, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27018) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
INFO:root:Running periodic database synchronization...
ERROR:root:Error during synchronization: localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 6870567a73f782119f4c0339, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27018) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
ERROR:root:Error during synchronization: localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 6870567a73f782119f4c0339, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27018) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Error enforcing retention policy: localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 6870567a73f782119f4c0339, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27018) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
ERROR:root:Error during synchronization: localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 6870567a73f782119f4c0339, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27018) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
INFO:root:Running periodic database synchronization...
ERROR:root:Error enforcing retention policy: localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 6870567a73f782119f4c0339, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27018) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Error during synchronization: localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 6870567a73f782119f4c0339, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27018) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
ERROR:root:Error enforcing retention policy: localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 6870567a73f782119f4c0339, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27018) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Error during synchronization: localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 6870567a73f782119f4c0339, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27018) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
ERROR:root:Error during synchronization: localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 6870567a73f782119f4c0339, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27018) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Error enforcing retention policy: localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 6870567a73f782119f4c0339, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27018) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
INFO:root:Running periodic database synchronization...
ERROR:root:Error during synchronization: localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 6870567a73f782119f4c0339, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27018) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
ERROR:root:Error enforcing retention policy: localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 6870567a73f782119f4c0339, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27018) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Error during synchronization: localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 6870567a73f782119f4c0339, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27018) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
INFO:root:Connected to primary MongoDB.
INFO:root:Connected to backup MongoDB.
INFO:root:Synchronizing all databases on startup...
ERROR:root:Error during synchronization: localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687058e4b0d63a29ef3c425f, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27018) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
INFO:root:Checking database consistency...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Server running on SMTP port 1026 and POP3 port 1102
INFO:root:Alice's POP3 server running on port 1102
INFO:root:Alice's SMTP server running on port 1026
ERROR:root:Error enforcing retention policy: localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687058e4b0d63a29ef3c425f, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27018) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Error during synchronization: localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687058e4b0d63a29ef3c425f, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27018) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
ERROR:root:Error during synchronization: localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687058e4b0d63a29ef3c425f, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27018) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Error during synchronization: localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687058e4b0d63a29ef3c425f, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27018) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Error enforcing retention policy: localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687058e4b0d63a29ef3c425f, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27018) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
INFO:root:Running periodic database synchronization...
ERROR:root:Error during synchronization: localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687058e4b0d63a29ef3c425f, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27018) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Error during synchronization: localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687058e4b0d63a29ef3c425f, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27018) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
ERROR:root:Error enforcing retention policy: localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687058e4b0d63a29ef3c425f, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27018) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Error during synchronization: localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687058e4b0d63a29ef3c425f, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27018) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27018: [Errno 54] Connection reset by peer (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
INFO:root:Running periodic database synchronization...
INFO:root:Connected to primary MongoDB.
INFO:root:Connected to backup MongoDB.
INFO:root:Synchronizing all databases on startup...
INFO:root:2025-07-11 00:30:00.889708 | User: alice@example.com | Action: send_email | Details: To: bob@example.com
INFO:root:2025-07-11 00:30:04.512724 | User: alice@example.com | Action: send_email | Details: To: bob@example.com
ERROR:root:Error during synchronization: No replica set members found yet, Timeout: 30s, Topology Description: <TopologyDescription id: 68705af0541e303cea559ce3, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None>]>
INFO:root:Checking database consistency...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Server running on SMTP port 1026 and POP3 port 1102
INFO:root:Alice's SMTP server running on port 1026
INFO:root:Alice's POP3 server running on port 1102
INFO:root:2025-07-11 00:30:07.666190 | User: alice@example.com | Action: send_email | Details: To: bob@example.com
INFO:root:2025-07-11 00:30:11.850240 | User: alice@example.com | Action: send_email | Details: To: bob@example.com
INFO:root:Raw email data received:
From: alice@example.com
To: bob@example.com
Encrypted-AES-Key: jHxX+qjK4X1dJ3HoLbKzf4AiMePJR7F6Wo8id9IMxUmcOKBejOt+jAXqXlbk5R/lBiCArA99Ap8YnEFDLTuEP30UaqSkCsv6NwU5wg8o+KvD/e8FLPUU/QHoW0OTVMICqjfehZLaPNpYI8IK187JUgNaRLEELwTiIvoiUeWJSnDivKhE0cYPu/SNIXvqWrTDnULw7ASvwpHL9BrhQ3+98kM3iaLDuvMldopySV/3WTGnEW8MYHCng6uwKg+qnE62VuAJSCJpIKis68Gl1WiVQGaJS6nY8cE2IJHEntfAzQfwpzjE0QOwx3WCaNFiCJsuwcTtlYK/R9Z4812t8MLqlw==
IV: 99C8J9I6D7u9ZX99++mg5w==
Message: XlefpX5ic2DXBJssSr7UtSu6IIuOMglZ5vLZu7U0Z5I=

INFO:root:Message stored in primary database.
INFO:root:Received POP3 request for: bob@example.com
INFO:root:Retrieved 2 messages from primary database for recipient: bob@example.com
INFO:root:Sent message to bob@example.com
INFO:root:Sent message to bob@example.com
ERROR:root:Error during synchronization: No replica set members found yet, Timeout: 30s, Topology Description: <TopologyDescription id: 68705af0541e303cea559ce3, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None>]>
ERROR:root:Error enforcing retention policy: No replica set members found yet, Timeout: 30s, Topology Description: <TopologyDescription id: 68705af0541e303cea559ce3, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None>]>
ERROR:root:Database health check failed: No replica set members found yet, Timeout: 30s, Topology Description: <TopologyDescription id: 68705af0541e303cea559ce3, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None>]>
WARNING:root:backup database is not available. Skipping write.
INFO:root:Running periodic database synchronization...
ERROR:root:Error during synchronization: No replica set members found yet, Timeout: 30s, Topology Description: <TopologyDescription id: 68705af0541e303cea559ce3, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None>]>
ERROR:root:Error handling SMTP client: [SYS] unknown error (_ssl.c:2427)
ERROR:root:Error during synchronization: No replica set members found yet, Timeout: 30s, Topology Description: <TopologyDescription id: 68705af0541e303cea559ce3, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None>]>
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
ERROR:root:Error enforcing retention policy: No replica set members found yet, Timeout: 30s, Topology Description: <TopologyDescription id: 68705af0541e303cea559ce3, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None>]>
ERROR:root:Error during synchronization: No replica set members found yet, Timeout: 30s, Topology Description: <TopologyDescription id: 68705af0541e303cea559ce3, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None>]>
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
ERROR:root:Error enforcing retention policy: No replica set members found yet, Timeout: 30s, Topology Description: <TopologyDescription id: 68705af0541e303cea559ce3, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None>]>
ERROR:root:Error during synchronization: No replica set members found yet, Timeout: 30s, Topology Description: <TopologyDescription id: 68705af0541e303cea559ce3, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None>]>
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
ERROR:root:Error during synchronization: No replica set members found yet, Timeout: 30s, Topology Description: <TopologyDescription id: 68705af0541e303cea559ce3, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None>]>
ERROR:root:Error enforcing retention policy: No replica set members found yet, Timeout: 30s, Topology Description: <TopologyDescription id: 68705af0541e303cea559ce3, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None>]>
INFO:root:Running periodic database synchronization...
ERROR:root:Error during synchronization: No replica set members found yet, Timeout: 30s, Topology Description: <TopologyDescription id: 68705af0541e303cea559ce3, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None>]>
ERROR:root:Error during synchronization: No replica set members found yet, Timeout: 30s, Topology Description: <TopologyDescription id: 68705af0541e303cea559ce3, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None>]>
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
ERROR:root:Error enforcing retention policy: No replica set members found yet, Timeout: 30s, Topology Description: <TopologyDescription id: 68705af0541e303cea559ce3, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None>]>
ERROR:root:Error during synchronization: No replica set members found yet, Timeout: 30s, Topology Description: <TopologyDescription id: 68705af0541e303cea559ce3, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None>]>
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
ERROR:root:Error during synchronization: No replica set members found yet, Timeout: 30s, Topology Description: <TopologyDescription id: 68705af0541e303cea559ce3, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None>]>
ERROR:root:Error enforcing retention policy: No replica set members found yet, Timeout: 30s, Topology Description: <TopologyDescription id: 68705af0541e303cea559ce3, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None>]>
INFO:root:Running periodic database synchronization...
ERROR:root:Error during synchronization: No replica set members found yet, Timeout: 30s, Topology Description: <TopologyDescription id: 68705af0541e303cea559ce3, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None>]>
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
ERROR:root:Error enforcing retention policy: No replica set members found yet, Timeout: 30s, Topology Description: <TopologyDescription id: 68705af0541e303cea559ce3, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None>]>
ERROR:root:Error during synchronization: No replica set members found yet, Timeout: 30s, Topology Description: <TopologyDescription id: 68705af0541e303cea559ce3, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None>]>
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
ERROR:root:Error during synchronization: No replica set members found yet, Timeout: 30s, Topology Description: <TopologyDescription id: 68705af0541e303cea559ce3, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None>]>
INFO:root:Connected to primary MongoDB.
INFO:root:Connected to backup MongoDB.
INFO:root:Synchronizing all databases on startup...
ERROR:root:Error during synchronization: No replica set members found yet, Timeout: 30s, Topology Description: <TopologyDescription id: 68706ed14f920b21e420252e, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None>]>
INFO:root:Checking database consistency...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Server running on SMTP port 1026 and POP3 port 1102
INFO:root:Alice's POP3 server running on port 1102
INFO:root:Alice's SMTP server running on port 1026
INFO:root:2025-07-11 01:55:03.971750 | User: alice@example.com | Action: send_email | Details: To: bob@example.com
INFO:root:2025-07-11 01:55:07.476970 | User: alice@example.com | Action: send_email | Details: To: bob@example.com
INFO:root:2025-07-11 01:55:17.079907 | User: alice@example.com | Action: send_email | Details: To: bob@example.com
INFO:root:2025-07-11 01:55:22.035015 | User: alice@example.com | Action: send_email | Details: To: bob@example.com
INFO:root:Raw email data received:
From: alice@example.com
To: bob@example.com
Encrypted-AES-Key: UAntuwzuekuZqMtNeaUV1bDaY5O3f4yBoSPXlcqixpB6jRKqQp92/Y2DNkYE+oZBMy03hVxiBLYfbyDD/RwmlAotaXjB8izO5nH3s3Qv9qEn8QeWVu2xpyrq7rTGQwD5DIOC6l7CB3hiHK/TX4waS5ctesYO+E03AZhqw0+bgBzpqPNEA3KgRHtPlqez4J1R9BeSuFJjnrPo+gqqPCmTP2+k2+HXpouSqzvobBuYwZjf+CKqDRDMTjud1omczsV4HjqxTtK8MimofKGNZYGnYcWKzTJxBqA567SsBsjNZ2jRntKcBlveYWHwcJIqIQThlUoTGQjiSxqHCrFUsFiRjg==
IV: iXpmbZ03aOzdVWs5Xh1Csg==
Message: zDX5j9IrLp/bP+gl+qlXDZfTuPI1Bywwvu5n73GbsBA=

INFO:root:Message stored in primary database.
ERROR:root:Error during synchronization: No replica set members found yet, Timeout: 30s, Topology Description: <TopologyDescription id: 68706ed14f920b21e420252e, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None>]>
ERROR:root:Error enforcing retention policy: No replica set members found yet, Timeout: 30s, Topology Description: <TopologyDescription id: 68706ed14f920b21e420252e, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None>]>
ERROR:root:Database health check failed: No replica set members found yet, Timeout: 30s, Topology Description: <TopologyDescription id: 68706ed14f920b21e420252e, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None>]>
WARNING:root:backup database is not available. Skipping write.
INFO:root:Running periodic database synchronization...
ERROR:root:Error during synchronization: No replica set members found yet, Timeout: 30s, Topology Description: <TopologyDescription id: 68706ed14f920b21e420252e, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None>]>
ERROR:root:Error handling SMTP client: [SYS] unknown error (_ssl.c:2427)
INFO:root:Enforcing retention policy...
ERROR:root:Error during synchronization: No replica set members found yet, Timeout: 30s, Topology Description: <TopologyDescription id: 68706ed14f920b21e420252e, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None>]>
INFO:root:Running periodic database synchronization...
ERROR:root:Error enforcing retention policy: No replica set members found yet, Timeout: 30s, Topology Description: <TopologyDescription id: 68706ed14f920b21e420252e, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None>]>
ERROR:root:Error during synchronization: No replica set members found yet, Timeout: 30s, Topology Description: <TopologyDescription id: 68706ed14f920b21e420252e, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None>]>
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
ERROR:root:Error during synchronization: No replica set members found yet, Timeout: 30s, Topology Description: <TopologyDescription id: 68706ed14f920b21e420252e, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None>]>
ERROR:root:Error enforcing retention policy: No replica set members found yet, Timeout: 30s, Topology Description: <TopologyDescription id: 68706ed14f920b21e420252e, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None>]>
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
ERROR:root:Database health check failed: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 68706ed14f920b21e420252d, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
ERROR:root:Error enforcing retention policy: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 68706ed14f920b21e420252d, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
INFO:root:Running periodic database synchronization...
ERROR:root:Database health check failed: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 68706ed14f920b21e420252d, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
ERROR:root:Database health check failed: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 68706ed14f920b21e420252d, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Error enforcing retention policy: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 68706ed14f920b21e420252d, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
ERROR:root:Database health check failed: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 68706ed14f920b21e420252d, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
ERROR:root:Error enforcing retention policy: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 68706ed14f920b21e420252d, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
INFO:root:Running periodic database synchronization...
INFO:root:Connected to primary MongoDB.
INFO:root:Connected to backup MongoDB.
INFO:root:Synchronizing all databases on startup...
INFO:root:2025-07-11 02:03:54.810347 | User: alice@example.com | Action: send_email | Details: To: bob@example.com
INFO:root:2025-07-11 02:03:57.395347 | User: alice@example.com | Action: send_email | Details: To: bob@example.com
INFO:root:2025-07-11 02:04:00.143215 | User: alice@example.com | Action: send_email | Details: To: bob@example.com
INFO:root:2025-07-11 02:04:02.600870 | User: alice@example.com | Action: send_email | Details: To: bob@example.com
INFO:root:2025-07-11 02:04:07.120013 | User: alice@example.com | Action: send_email | Details: To: bob@example.com
ERROR:root:Database health check failed: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687070f99baac145a9ce29d8, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
INFO:root:Checking database consistency...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Server running on SMTP port 1026 and POP3 port 1102
INFO:root:Alice's SMTP server running on port 1026
INFO:root:Alice's POP3 server running on port 1102
INFO:root:2025-07-11 02:04:12.470823 | User: alice@example.com | Action: send_email | Details: To: bob@example.com
INFO:root:Raw email data received:
From: alice@example.com
To: bob@example.com
Encrypted-AES-Key: lL5yCJFR1JKrll/UOjFoxeMwHn2UChciSDQuoMhH8jyR04IydmgFW+T6qp3/AUO0f+Xa8avM90nC1HaAZXGbGNklwgLY7x3Z/IGfj6dKHb/X10+Qebza2+evM3G8Q5G+xSt8uQOdOPyzN9Cm4+8ugZ6mxi9mjZYbKihuuc7F6GeO6m4hPdVWkIIVDx21dGvyfvlls3yONPnfm3YY6XABx/ngcp0PSb3wCSSdKQgfYZMEWnsWG7yD0T++oMNX3wFeFLv0oxUrRtQfrvI4yRMpqn25fZ5JCiirmE6aMqdai9tsMC0DgvSE3uBkdv+hMoRO6mnrYUKmRXOmCnn4qUJhtQ==
IV: xwwX3/1CgCUQHJU3Mq5OlA==
Message: EPmhYmjIKpGoLT7y70/81av7qkcKrk4W01KbZ4fLfdE=

ERROR:root:Database health check failed: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687070f99baac145a9ce29d8, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Error enforcing retention policy: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687070f99baac145a9ce29d8, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
ERROR:root:Database health check failed: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687070f99baac145a9ce29d8, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:primary database is not available. Skipping write.
INFO:root:Running periodic database synchronization...
ERROR:root:Database health check failed: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687070f99baac145a9ce29d9, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:backup database is not available. Skipping write.
INFO:root:Enforcing retention policy...
ERROR:root:Database health check failed: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687070f99baac145a9ce29d8, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
ERROR:root:Database health check failed: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687070f99baac145a9ce29d8, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
ERROR:root:Error handling SMTP client: [SYS] unknown error (_ssl.c:2427)
INFO:root:Running periodic database synchronization...
ERROR:root:Error enforcing retention policy: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687070f99baac145a9ce29d8, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Database health check failed: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687070f99baac145a9ce29d8, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
ERROR:root:Error enforcing retention policy: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687070f99baac145a9ce29d8, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Database health check failed: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687070f99baac145a9ce29d8, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
ERROR:root:Database health check failed: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687070f99baac145a9ce29d8, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
ERROR:root:Error enforcing retention policy: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687070f99baac145a9ce29d8, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
INFO:root:Running periodic database synchronization...
ERROR:root:Database health check failed: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687070f99baac145a9ce29d8, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
ERROR:root:Error enforcing retention policy: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687070f99baac145a9ce29d8, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Database health check failed: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687070f99baac145a9ce29d8, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
ERROR:root:Database health check failed: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687070f99baac145a9ce29d8, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
ERROR:root:Error enforcing retention policy: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687070f99baac145a9ce29d8, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
INFO:root:Running periodic database synchronization...
ERROR:root:Database health check failed: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687070f99baac145a9ce29d8, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
ERROR:root:Error enforcing retention policy: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687070f99baac145a9ce29d8, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Database health check failed: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687070f99baac145a9ce29d8, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
ERROR:root:Database health check failed: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687070f99baac145a9ce29d8, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
ERROR:root:Error enforcing retention policy: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687070f99baac145a9ce29d8, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
INFO:root:Running periodic database synchronization...
ERROR:root:Database health check failed: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687070f99baac145a9ce29d8, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
ERROR:root:Error enforcing retention policy: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687070f99baac145a9ce29d8, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Database health check failed: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687070f99baac145a9ce29d8, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
ERROR:root:Database health check failed: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687070f99baac145a9ce29d8, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
ERROR:root:Error enforcing retention policy: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687070f99baac145a9ce29d8, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
INFO:root:Running periodic database synchronization...
ERROR:root:Database health check failed: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687070f99baac145a9ce29d8, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
ERROR:root:Error enforcing retention policy: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687070f99baac145a9ce29d8, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Database health check failed: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687070f99baac145a9ce29d8, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
ERROR:root:Database health check failed: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687070f99baac145a9ce29d8, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
ERROR:root:Error enforcing retention policy: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687070f99baac145a9ce29d8, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
INFO:root:Running periodic database synchronization...
ERROR:root:Database health check failed: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687070f99baac145a9ce29d8, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
ERROR:root:Error enforcing retention policy: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687070f99baac145a9ce29d8, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Database health check failed: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687070f99baac145a9ce29d8, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
ERROR:root:Database health check failed: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687070f99baac145a9ce29d8, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
ERROR:root:Error enforcing retention policy: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687070f99baac145a9ce29d8, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
INFO:root:Running periodic database synchronization...
ERROR:root:Database health check failed: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687070f99baac145a9ce29d8, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
ERROR:root:Error enforcing retention policy: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687070f99baac145a9ce29d8, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Database health check failed: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687070f99baac145a9ce29d8, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
ERROR:root:Database health check failed: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687070f99baac145a9ce29d8, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
ERROR:root:Error enforcing retention policy: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687070f99baac145a9ce29d8, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
INFO:root:Running periodic database synchronization...
ERROR:root:Database health check failed: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687070f99baac145a9ce29d8, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
ERROR:root:Error enforcing retention policy: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687070f99baac145a9ce29d8, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Database health check failed: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687070f99baac145a9ce29d8, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
ERROR:root:Database health check failed: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687070f99baac145a9ce29d8, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
ERROR:root:Error enforcing retention policy: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687070f99baac145a9ce29d8, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
INFO:root:Running periodic database synchronization...
ERROR:root:Database health check failed: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687070f99baac145a9ce29d8, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
ERROR:root:Error enforcing retention policy: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687070f99baac145a9ce29d8, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Database health check failed: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687070f99baac145a9ce29d8, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
ERROR:root:Database health check failed: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687070f99baac145a9ce29d8, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
ERROR:root:Error enforcing retention policy: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687070f99baac145a9ce29d8, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
INFO:root:Running periodic database synchronization...
ERROR:root:Database health check failed: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687070f99baac145a9ce29d8, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
ERROR:root:Error enforcing retention policy: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687070f99baac145a9ce29d8, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Database health check failed: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687070f99baac145a9ce29d8, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
ERROR:root:Database health check failed: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687070f99baac145a9ce29d8, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
ERROR:root:Error enforcing retention policy: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687070f99baac145a9ce29d8, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
INFO:root:Running periodic database synchronization...
ERROR:root:Database health check failed: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687070f99baac145a9ce29d8, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
ERROR:root:Error enforcing retention policy: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687070f99baac145a9ce29d8, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Database health check failed: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687070f99baac145a9ce29d8, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
INFO:root:Connected to primary MongoDB.
INFO:root:Connected to backup MongoDB.
INFO:root:Synchronizing all databases on startup...
INFO:root:2025-07-11 04:44:10.732509 | User: alice@example.com | Action: send_email | Details: To: bob@example.com
INFO:root:2025-07-11 04:44:14.203269 | User: alice@example.com | Action: send_email | Details: To: bob@example.com
INFO:root:2025-07-11 04:44:17.861715 | User: alice@example.com | Action: send_email | Details: To: bob@example.com
INFO:root:2025-07-11 04:44:20.110473 | User: alice@example.com | Action: send_email | Details: To: bob@example.com
INFO:root:2025-07-11 04:44:23.922156 | User: alice@example.com | Action: send_email | Details: To: bob@example.com
INFO:root:2025-07-11 04:44:28.134012 | User: alice@example.com | Action: send_email | Details: To: bob@example.com
ERROR:root:Database health check failed: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687096932d48ebc8769a7344, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
INFO:root:Checking database consistency...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Server running on SMTP port 1026 and POP3 port 1102
INFO:root:Alice's POP3 server running on port 1102
INFO:root:Alice's SMTP server running on port 1026
INFO:root:Connected to primary MongoDB.
INFO:root:Connected to backup MongoDB.
INFO:root:Synchronizing all databases on startup...
INFO:root:2025-07-11 04:45:15.381892 | User: alice@example.com | Action: send_email | Details: To: bob@example.com
INFO:root:2025-07-11 04:45:22.637046 | User: alice@example.com | Action: send_email | Details: To: bob@example.com
INFO:root:2025-07-11 04:45:27.934071 | User: alice@example.com | Action: send_email | Details: To: bob@example.com
ERROR:root:Database health check failed: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687096d12267ba10f8bcf681, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
INFO:root:Checking database consistency...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Server running on SMTP port 1026 and POP3 port 1102
INFO:root:Alice's SMTP server running on port 1026
INFO:root:Alice's POP3 server running on port 1102
INFO:root:2025-07-11 04:45:37.413540 | User: alice@example.com | Action: send_email | Details: To: bob@example.com
INFO:root:Raw email data received:
From: alice@example.com
To: bob@example.com
Encrypted-AES-Key: RCT+It7/7/zlYIzO/dqqpbDA0cMCqk0aI3899ENOAoT8TRQB5I1kV4qE0guQEAl23otvY+npuw+JDqC1iA9wRLjn0SNYEdE60EfuWUDktIpmoyc3knfY5BrGK84uc820Qm162IOFWzNwQCD3z8ODcAt1ND3FtUbMquFtfv4M+UeKOwFfiqntvn0V99Tfs0ZJvPB21YKhlTA44lmcL7llr6VS2vtfvQan228GRIi+d5MG2Cf6WI/BXiy4DagkbZvbdr3Itq/n8hv4UO8AJ36hcJBCzW3hUcSD3LnTjcHM4rHfyMFwV0GqIZhB5rUqLPgDXhYg5CY2R6sJYmaFwLSwgg==
IV: NUKujRQABM2vWYVkJZM8GA==
Message: Cs7C/ykZYUtXfjomYLsWzGuwca0lJp7SPgjbG3o8Yz0=

ERROR:root:Error enforcing retention policy: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687096d12267ba10f8bcf681, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Database health check failed: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687096d12267ba10f8bcf681, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
ERROR:root:Database health check failed: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687096d12267ba10f8bcf681, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:primary database is not available. Skipping write.
INFO:root:Received POP3 request for: alice@example.com
INFO:root:Running periodic database synchronization...
ERROR:root:Database health check failed: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687096d12267ba10f8bcf682, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:backup database is not available. Skipping write.
ERROR:root:Database health check failed: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687096d12267ba10f8bcf681, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
INFO:root:Enforcing retention policy...
ERROR:root:Database health check failed: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687096d12267ba10f8bcf681, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
ERROR:root:Database health check failed: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687096d12267ba10f8bcf681, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
ERROR:root:Error handling SMTP client: [SYS] unknown error (_ssl.c:2427)
ERROR:root:Error retrieving messages from backup database: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687096d12267ba10f8bcf682, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:No messages found for recipient: alice@example.com
INFO:root:Running periodic database synchronization...
ERROR:root:Error enforcing retention policy: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687096d12267ba10f8bcf681, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Database health check failed: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687096d12267ba10f8bcf681, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
ERROR:root:Database health check failed: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687096d12267ba10f8bcf681, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Error enforcing retention policy: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687096d12267ba10f8bcf681, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
ERROR:root:Database health check failed: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687096d12267ba10f8bcf681, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
INFO:root:Running periodic database synchronization...
ERROR:root:Error enforcing retention policy: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687096d12267ba10f8bcf681, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Database health check failed: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687096d12267ba10f8bcf681, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
ERROR:root:Error enforcing retention policy: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687096d12267ba10f8bcf681, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Database health check failed: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687096d12267ba10f8bcf681, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
ERROR:root:Database health check failed: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687096d12267ba10f8bcf681, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
INFO:root:Running periodic database synchronization...
ERROR:root:Error enforcing retention policy: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687096d12267ba10f8bcf681, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Database health check failed: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687096d12267ba10f8bcf681, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
ERROR:root:Error enforcing retention policy: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687096d12267ba10f8bcf681, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Database health check failed: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687096d12267ba10f8bcf681, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
ERROR:root:Database health check failed: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687096d12267ba10f8bcf681, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
INFO:root:Running periodic database synchronization...
ERROR:root:Error enforcing retention policy: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687096d12267ba10f8bcf681, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Database health check failed: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687096d12267ba10f8bcf681, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
ERROR:root:Error enforcing retention policy: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687096d12267ba10f8bcf681, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Database health check failed: mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 687096d12267ba10f8bcf681, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
INFO:root:Running periodic database synchronization...
INFO:root:Connected to primary MongoDB.
INFO:root:Connected to backup MongoDB.
INFO:root:Synchronizing all databases on startup...
ERROR:root:Error during synchronization: not primary, full error: {'topologyVersion': {'processId': ObjectId('687094ddd0b9d1eba6fcd9c5'), 'counter': 4}, 'ok': 0.0, 'errmsg': 'not primary', 'code': 10107, 'codeName': 'NotWritablePrimary', '$clusterTime': {'clusterTime': Timestamp(1752209983, 1), 'signature': {'hash': b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00', 'keyId': 0}}, 'operationTime': Timestamp(1752209983, 1)}
INFO:root:Checking database consistency...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Server running on SMTP port 1026 and POP3 port 1102
INFO:root:Alice's SMTP server running on port 1026
INFO:root:Alice's POP3 server running on port 1102
ERROR:root:Error during synchronization: not primary, full error: {'topologyVersion': {'processId': ObjectId('687094ddd0b9d1eba6fcd9c5'), 'counter': 4}, 'ok': 0.0, 'errmsg': 'not primary', 'code': 10107, 'codeName': 'NotWritablePrimary', '$clusterTime': {'clusterTime': Timestamp(1752209983, 1), 'signature': {'hash': b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00', 'keyId': 0}}, 'operationTime': Timestamp(1752209983, 1)}
INFO:root:Running periodic database synchronization...
ERROR:root:Error during synchronization: not primary, full error: {'topologyVersion': {'processId': ObjectId('687094ddd0b9d1eba6fcd9c5'), 'counter': 4}, 'ok': 0.0, 'errmsg': 'not primary', 'code': 10107, 'codeName': 'NotWritablePrimary', '$clusterTime': {'clusterTime': Timestamp(1752210013, 1), 'signature': {'hash': b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00', 'keyId': 0}}, 'operationTime': Timestamp(1752210013, 1)}
INFO:root:2025-07-11 05:00:43.919010 | User: alice@example.com | Action: send_email | Details: To: bob@example.com
INFO:root:Raw email data received:
From: alice@example.com
To: bob@example.com
Encrypted-AES-Key: HE52VFYmVeTkjItLXBwyN1/BosnfwyIBJ0J/wjHy+W/31gRk9+rWQhG8F6pHMiKBqp9jzwrmTwnGSjBhXO3V1yxv1hr9DfJlSyeqqL2ub0PrLcj2NsWINlop3XsLiMpHOruylYtchTRCIUECLN6mJB/ub5VxaqTFi2pz2m/g1LzBGYcYaztESmL4RhySTIm/ojdGpU3mMsMA8IJnvjeFk1YwXpUoD4jkjjTee8yAtuBul8FdHhn9ebBk2EBxm73y45vWXBnwm0vVcRGChlqlyUaC4ImJUMPjwlA5L83IH17m//eOL3KS0L5sB2bgLLT86E0igWGbD+l6fPO3jQd4Zg==
IV: 2nXD+qlQ5rW9uIWknzr7ww==
Message: pjV/SwD+eIRvQr2nJmONnrguLYm9ULhZpSYvpTfJ6ZM=

INFO:root:Message stored in primary database.
ERROR:root:Error storing message in backup database: not primary, full error: {'topologyVersion': {'processId': ObjectId('687094ddd0b9d1eba6fcd9c5'), 'counter': 4}, 'ok': 0.0, 'errmsg': 'not primary', 'code': 10107, 'codeName': 'NotWritablePrimary', '$clusterTime': {'clusterTime': Timestamp(1752210044, 1), 'signature': {'hash': b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00', 'keyId': 0}}, 'operationTime': Timestamp(1752210044, 1)}
ERROR:root:Error during synchronization: not primary, full error: {'topologyVersion': {'processId': ObjectId('687094ddd0b9d1eba6fcd9c5'), 'counter': 4}, 'ok': 0.0, 'errmsg': 'not primary', 'code': 10107, 'codeName': 'NotWritablePrimary', '$clusterTime': {'clusterTime': Timestamp(1752210044, 1), 'signature': {'hash': b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00', 'keyId': 0}}, 'operationTime': Timestamp(1752210044, 1)}
INFO:root:Message stored for recipients: ['bob@example.com']
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
ERROR:root:Error during synchronization: not primary, full error: {'topologyVersion': {'processId': ObjectId('687094ddd0b9d1eba6fcd9c5'), 'counter': 4}, 'ok': 0.0, 'errmsg': 'not primary', 'code': 10107, 'codeName': 'NotWritablePrimary', '$clusterTime': {'clusterTime': Timestamp(1752210044, 1), 'signature': {'hash': b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00', 'keyId': 0}}, 'operationTime': Timestamp(1752210044, 1)}
INFO:root:Received POP3 request for: alice@example.com
INFO:root:Retrieved 1 messages from primary database for recipient: alice@example.com
INFO:root:Sent message to alice@example.com
INFO:root:Running periodic database synchronization...
ERROR:root:Error during synchronization: not primary, full error: {'topologyVersion': {'processId': ObjectId('687094ddd0b9d1eba6fcd9c5'), 'counter': 4}, 'ok': 0.0, 'errmsg': 'not primary', 'code': 10107, 'codeName': 'NotWritablePrimary', '$clusterTime': {'clusterTime': Timestamp(1752210073, 1), 'signature': {'hash': b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00', 'keyId': 0}}, 'operationTime': Timestamp(1752210073, 1)}
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
ERROR:root:Error during synchronization: not primary, full error: {'topologyVersion': {'processId': ObjectId('687094ddd0b9d1eba6fcd9c5'), 'counter': 4}, 'ok': 0.0, 'errmsg': 'not primary', 'code': 10107, 'codeName': 'NotWritablePrimary', '$clusterTime': {'clusterTime': Timestamp(1752210106, 15), 'signature': {'hash': b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00', 'keyId': 0}}, 'operationTime': Timestamp(1752210106, 15)}
INFO:root:Running periodic database synchronization...
ERROR:root:Error during synchronization: not primary, full error: {'topologyVersion': {'processId': ObjectId('687094ddd0b9d1eba6fcd9c5'), 'counter': 4}, 'ok': 0.0, 'errmsg': 'not primary', 'code': 10107, 'codeName': 'NotWritablePrimary', '$clusterTime': {'clusterTime': Timestamp(1752210133, 1), 'signature': {'hash': b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00', 'keyId': 0}}, 'operationTime': Timestamp(1752210133, 1)}
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
ERROR:root:Error during synchronization: not primary, full error: {'topologyVersion': {'processId': ObjectId('687094ddd0b9d1eba6fcd9c5'), 'counter': 4}, 'ok': 0.0, 'errmsg': 'not primary', 'code': 10107, 'codeName': 'NotWritablePrimary', '$clusterTime': {'clusterTime': Timestamp(1752210163, 1), 'signature': {'hash': b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00', 'keyId': 0}}, 'operationTime': Timestamp(1752210163, 1)}
INFO:root:Running periodic database synchronization...
ERROR:root:Error during synchronization: not primary, full error: {'topologyVersion': {'processId': ObjectId('687094ddd0b9d1eba6fcd9c5'), 'counter': 4}, 'ok': 0.0, 'errmsg': 'not primary', 'code': 10107, 'codeName': 'NotWritablePrimary', '$clusterTime': {'clusterTime': Timestamp(1752210193, 1), 'signature': {'hash': b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00', 'keyId': 0}}, 'operationTime': Timestamp(1752210193, 1)}
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
ERROR:root:Error during synchronization: not primary, full error: {'topologyVersion': {'processId': ObjectId('687094ddd0b9d1eba6fcd9c5'), 'counter': 4}, 'ok': 0.0, 'errmsg': 'not primary', 'code': 10107, 'codeName': 'NotWritablePrimary', '$clusterTime': {'clusterTime': Timestamp(1752210223, 1), 'signature': {'hash': b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00', 'keyId': 0}}, 'operationTime': Timestamp(1752210223, 1)}
INFO:root:Running periodic database synchronization...
ERROR:root:Error during synchronization: not primary, full error: {'topologyVersion': {'processId': ObjectId('687094ddd0b9d1eba6fcd9c5'), 'counter': 4}, 'ok': 0.0, 'errmsg': 'not primary', 'code': 10107, 'codeName': 'NotWritablePrimary', '$clusterTime': {'clusterTime': Timestamp(1752210253, 1), 'signature': {'hash': b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00', 'keyId': 0}}, 'operationTime': Timestamp(1752210253, 1)}
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Connected to primary MongoDB.
INFO:root:Connected to backup MongoDB.
INFO:root:Synchronizing all databases on startup...
ERROR:root:Database health check failed: localhost:27017: [Errno 61] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 68709b7d2a57864b59e56a3a, topology_type: Single, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 61] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
INFO:root:Checking database consistency...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Server running on SMTP port 1026 and POP3 port 1102
INFO:root:Alice's POP3 server running on port 1102
INFO:root:Alice's SMTP server running on port 1026
INFO:root:Raw email data received:
From: bob@example.com
To: alice@example.com
Encrypted-AES-Key: Kr45/UXPkQvdaLLVBTpmHP8eeaCXMZFpHDEyNE5zh/+S7hmB5KQeM/i/5GCl4WgXE5zzUpd+oVCgoKzS9FVaq9YkHxFNVTkPdwE7o9+PjkxgLPZRuCjv+b7P8HzAR5QFUJJrkn4jvaU55GyxJRDClnuijIMgbgPy63G/DfwZ7YhlOEWYET9zO07n0JetJHNr/ii1m9/T2oqZgGoH3a5nKhVe3U7mQWYYeK8xOoOPplp8oavdUdsKiiNUzsUuU2ZUbVjuS8q/7d6vVESESD7yRA3ZCLkYf4h4WDqB6Hejy58fu+kN4Z8cJsBlGTFdtlkhZWI93KJ16PMgMr+Ldyi+bw==
IV: V14aALRgmnp84sBkYFLWZg==
Message: nhSpAXuRAuOq33JcpEWFHy105w9ACG5WIXPa3bW6PHU=

INFO:root:2025-07-11 05:05:50.761656 | User: alice@example.com | Action: send_email | Details: To: bob@example.com
INFO:root:Received POP3 request for: alice@example.com
ERROR:root:Database health check failed: localhost:27017: [Errno 61] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 68709b7d2a57864b59e56a3a, topology_type: Single, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 61] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Error enforcing retention policy: localhost:27017: [Errno 61] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 68709b7d2a57864b59e56a3a, topology_type: Single, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 61] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
ERROR:root:Database health check failed: localhost:27017: [Errno 61] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 68709b7d2a57864b59e56a3a, topology_type: Single, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 61] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:primary database is not available. Skipping write.
ERROR:root:Error storing message in backup database: not primary, full error: {'topologyVersion': {'processId': ObjectId('687094ddd0b9d1eba6fcd9c5'), 'counter': 4}, 'ok': 0.0, 'errmsg': 'not primary', 'code': 10107, 'codeName': 'NotWritablePrimary', '$clusterTime': {'clusterTime': Timestamp(1752210273, 1), 'signature': {'hash': b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00', 'keyId': 0}}, 'operationTime': Timestamp(1752210273, 1)}
ERROR:root:Database health check failed: localhost:27017: [Errno 61] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 68709b7d2a57864b59e56a3a, topology_type: Single, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 61] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:No messages found for recipient: alice@example.com in backup database.
WARNING:root:No messages found for recipient: alice@example.com
INFO:root:Running periodic database synchronization...
ERROR:root:Database health check failed: localhost:27017: [Errno 61] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 68709b7d2a57864b59e56a3a, topology_type: Single, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 61] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
ERROR:root:Error handling SMTP client: [SYS] unknown error (_ssl.c:2427)
INFO:root:Enforcing retention policy...
ERROR:root:Database health check failed: localhost:27017: [Errno 61] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 68709b7d2a57864b59e56a3a, topology_type: Single, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 61] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
INFO:root:Running periodic database synchronization...
ERROR:root:Error enforcing retention policy: localhost:27017: [Errno 61] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 68709b7d2a57864b59e56a3a, topology_type: Single, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 61] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Database health check failed: localhost:27017: [Errno 61] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 68709b7d2a57864b59e56a3a, topology_type: Single, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 61] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
ERROR:root:Error enforcing retention policy: localhost:27017: [Errno 61] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 68709b7d2a57864b59e56a3a, topology_type: Single, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 61] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Database health check failed: localhost:27017: [Errno 61] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 68709b7d2a57864b59e56a3a, topology_type: Single, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 61] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
INFO:root:Connected to primary MongoDB.
INFO:root:Connected to backup MongoDB.
INFO:root:Synchronizing all databases on startup...
INFO:root:2025-07-11 05:10:32.943251 | User: alice@example.com | Action: send_email | Details: To: bob@example.com
ERROR:root:Database health check failed: localhost:27017: [Errno 61] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 68709cac42e8f027e11a70cc, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 61] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
INFO:root:Checking database consistency...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Server running on SMTP port 1026 and POP3 port 1102
INFO:root:Alice's POP3 server running on port 1102
INFO:root:Alice's SMTP server running on port 1026
INFO:root:2025-07-11 05:10:58.627303 | User: alice@example.com | Action: send_email | Details: To: bob@example.com
INFO:root:Raw email data received:
From: alice@example.com
To: bob@example.com
Encrypted-AES-Key: FKIk9FZu5Ez/P3MCQC69fySAy9ls3ZzbxpZf42VBbOpfjtIwFehOTWC+QJGhn/uENIrk/Y6J3JIEUKipsyX3mZezs67yoQ65mli3tGuE6TQwLw+5S7l19Rcvjbt/xnTHjjVGlLNwPsv9Vju5D5iaQzJzMO4C1aynO2lqX/HgV1NwE3xT3O66E8pAOAqJP5rShGpdYlf1ZxMcqDwoDTLzYHL3o1J6m4LXFYO6wld5p5zld6o9SUuLnGmms/p48qrp3EKZ10e05wsXjVxC4RuSlCQHWps9dMjrWoj8YljpquTNe6g6tlSPcVjcQb3SG/MsPTQ7SPzmRo5JWE4JUBfr9w==
IV: 2DiGSP+0OHFmf1iLAIjvAA==
Message: xNsjS+/er1qLeUU64LIsNuzS9f9d6hd1CZ/zGVUFG3Y=

ERROR:root:Database health check failed: localhost:27017: [Errno 61] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 68709cac42e8f027e11a70cc, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 61] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Error enforcing retention policy: localhost:27017: [Errno 61] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 68709cac42e8f027e11a70cc, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 61] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
INFO:root:Received POP3 request for: bob@example.com
ERROR:root:Database health check failed: localhost:27017: [Errno 61] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 68709cac42e8f027e11a70cc, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 61] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:primary database is not available. Skipping write.
INFO:root:Running periodic database synchronization...
ERROR:root:Database health check failed: localhost:27017: [Errno 61] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 68709cac42e8f027e11a70cc, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 61] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Database health check failed: mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 68709cac42e8f027e11a70cd, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:backup database is not available. Skipping write.
INFO:root:Enforcing retention policy...
ERROR:root:Database health check failed: localhost:27017: [Errno 61] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 68709cac42e8f027e11a70cc, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 61] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
ERROR:root:Error retrieving messages from backup database: mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 68709cac42e8f027e11a70cd, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:No messages found for recipient: bob@example.com
ERROR:root:Database health check failed: localhost:27017: [Errno 61] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 68709cac42e8f027e11a70cc, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 61] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
ERROR:root:Error handling SMTP client: [SYS] unknown error (_ssl.c:2427)
INFO:root:Running periodic database synchronization...
ERROR:root:Error enforcing retention policy: localhost:27017: [Errno 61] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 68709cac42e8f027e11a70cc, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 61] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Database health check failed: localhost:27017: [Errno 61] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 68709cac42e8f027e11a70cc, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 61] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
ERROR:root:Database health check failed: mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 68709cac42e8f027e11a70cc, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Error enforcing retention policy: mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 68709cac42e8f027e11a70cc, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
ERROR:root:Database health check failed: mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 68709cac42e8f027e11a70cc, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
INFO:root:Running periodic database synchronization...
ERROR:root:Error enforcing retention policy: mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 68709cac42e8f027e11a70cc, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Database health check failed: mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 68709cac42e8f027e11a70cc, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
ERROR:root:Database health check failed: mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 68709cac42e8f027e11a70cc, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
ERROR:root:Database health check failed: mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 68709cac42e8f027e11a70cc, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Error enforcing retention policy: mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 68709cac42e8f027e11a70cc, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
ERROR:root:Database health check failed: mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 68709cac42e8f027e11a70cc, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
INFO:root:Running periodic database synchronization...
ERROR:root:Error enforcing retention policy: mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 68709cac42e8f027e11a70cc, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Database health check failed: mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 68709cac42e8f027e11a70cc, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
ERROR:root:Database health check failed: mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 68709cac42e8f027e11a70cc, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Error enforcing retention policy: mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 68709cac42e8f027e11a70cc, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
ERROR:root:Database health check failed: mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 68709cac42e8f027e11a70cc, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
INFO:root:Running periodic database synchronization...
ERROR:root:Error enforcing retention policy: mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 68709cac42e8f027e11a70cc, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Database health check failed: mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 68709cac42e8f027e11a70cc, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_backup:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>, <ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 8] nodename nor servname provided, or not known (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
INFO:root:Connected to primary MongoDB.
INFO:root:Connected to backup MongoDB.
INFO:root:Synchronizing all databases on startup...
ERROR:root:Database health check failed: No replica set members match selector "Primary()", Timeout: 30s, Topology Description: <TopologyDescription id: 68709fbd90da362f7e01c3cd, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('mongo_primary', 27017) server_type: RSSecondary, rtt: 0.002563292542879936>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
INFO:root:Checking database consistency...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Server running on SMTP port 1026 and POP3 port 1102
INFO:root:Alice's POP3 server running on port 1102
INFO:root:Alice's SMTP server running on port 1026
INFO:root:2025-07-11 05:23:46.666726 | User: alice@example.com | Action: send_email | Details: To: bob@example.com
INFO:root:Raw email data received:
From: bob@example.com
To: alice@example.com
Encrypted-AES-Key: GR9WPLlDX6nUo2UMtj3lCHt7zA3eSF0NgRbRNFJYGoRED9O/DUj2jvLqwHrIHsM2f3EOCx9Vwo9K8AdxH4PEW9ihLB/YoYfk325NYq9N1gqX870fdgWH5EVKj/3Q6rdMnPmKMQBYjnKGuN/xZArMsAgdA7r9R+uEWmHO2AfvZD3WBLc505khw/yy9ZSON0xBUeyU4nobR9vLopHt8TFpRTKZxaA9/sSf/aDHx+8+r/Kt1IDNqYxyA6/+Dk4r2KS5wNOju8Xz+YMvbF14HrKN2HBRr+JIfzXpETRvLIy6YdVf5vn5uTv3SVuzDnBLwWOQ9c7/IVMkb6kAo23tLEkMRg==
IV: TRDlZ8o3MoxACocXYY730A==
Message: rmvgENgsJi9raomLCFeOXnCpHBDxvlUeG1HKyFgTTyk=

ERROR:root:Database health check failed: No replica set members match selector "Primary()", Timeout: 30s, Topology Description: <TopologyDescription id: 68709fbd90da362f7e01c3cd, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('mongo_primary', 27017) server_type: RSSecondary, rtt: 0.009298190389923055>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
ERROR:root:Error enforcing retention policy: No replica set members match selector "Primary()", Timeout: 30s, Topology Description: <TopologyDescription id: 68709fbd90da362f7e01c3cd, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('mongo_primary', 27017) server_type: RSSecondary, rtt: 0.009298190389923055>]>
INFO:root:Received POP3 request for: alice@example.com
ERROR:root:Database health check failed: No replica set members match selector "Primary()", Timeout: 30s, Topology Description: <TopologyDescription id: 68709fbd90da362f7e01c3cd, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_primary', 27017) server_type: RSSecondary, rtt: 0.012238969112510285>]>
WARNING:root:primary database is not available. Skipping write.
INFO:root:Running periodic database synchronization...
ERROR:root:Database health check failed: No replica set members match selector "Primary()", Timeout: 30s, Topology Description: <TopologyDescription id: 68709fbd90da362f7e01c3cd, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_primary', 27017) server_type: RSSecondary, rtt: 0.016843401791380237>]>
ERROR:root:Database health check failed: No replica set members match selector "Primary()", Timeout: 30s, Topology Description: <TopologyDescription id: 68709fbd90da362f7e01c3ce, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_primary', 27017) server_type: RSSecondary, rtt: 0.01786528445678457>]>
WARNING:root:backup database is not available. Skipping write.
INFO:root:Enforcing retention policy...
ERROR:root:Database health check failed: No replica set members match selector "Primary()", Timeout: 30s, Topology Description: <TopologyDescription id: 68709fbd90da362f7e01c3cd, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('mongo_primary', 27017) server_type: RSSecondary, rtt: 0.017590484350041107>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
ERROR:root:Error retrieving messages from backup database: No replica set members match selector "Primary()", Timeout: 30s, Topology Description: <TopologyDescription id: 68709fbd90da362f7e01c3ce, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_primary', 27017) server_type: RSSecondary, rtt: 0.018592590452469>]>
WARNING:root:No messages found for recipient: alice@example.com
ERROR:root:Database health check failed: No replica set members match selector "Primary()", Timeout: 30s, Topology Description: <TopologyDescription id: 68709fbd90da362f7e01c3cd, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_primary', 27017) server_type: RSSecondary, rtt: 0.01661377927963764>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
ERROR:root:Error handling SMTP client: [SYS] unknown error (_ssl.c:2427)
ERROR:root:Error enforcing retention policy: No replica set members match selector "Primary()", Timeout: 30s, Topology Description: <TopologyDescription id: 68709fbd90da362f7e01c3cd, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('mongo_primary', 27017) server_type: RSSecondary, rtt: 0.01490473873943298>]>
INFO:root:Running periodic database synchronization...
ERROR:root:Database health check failed: No replica set members match selector "Primary()", Timeout: 30s, Topology Description: <TopologyDescription id: 68709fbd90da362f7e01c3cd, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('mongo_primary', 27017) server_type: RSSecondary, rtt: 0.01583867625142795>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
ERROR:root:Database health check failed: No replica set members match selector "Primary()", Timeout: 30s, Topology Description: <TopologyDescription id: 68709fbd90da362f7e01c3cd, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('mongo_primary', 27017) server_type: RSSecondary, rtt: 0.01795202082275721>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
ERROR:root:Error enforcing retention policy: No replica set members match selector "Primary()", Timeout: 30s, Topology Description: <TopologyDescription id: 68709fbd90da362f7e01c3cd, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('mongo_primary', 27017) server_type: RSSecondary, rtt: 0.01795202082275721>]>
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
ERROR:root:Database health check failed: No replica set members match selector "Primary()", Timeout: 30s, Topology Description: <TopologyDescription id: 68709fbd90da362f7e01c3cd, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('mongo_primary', 27017) server_type: RSSecondary, rtt: 0.015732688628656837>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
INFO:root:Running periodic database synchronization...
ERROR:root:Error enforcing retention policy: No replica set members match selector "Primary()", Timeout: 30s, Topology Description: <TopologyDescription id: 68709fbd90da362f7e01c3cd, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('mongo_primary', 27017) server_type: RSSecondary, rtt: 0.016168431298376505>]>
ERROR:root:Database health check failed: No replica set members match selector "Primary()", Timeout: 30s, Topology Description: <TopologyDescription id: 68709fbd90da362f7e01c3cd, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('mongo_primary', 27017) server_type: RSSecondary, rtt: 0.019300323448388314>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
ERROR:root:Database health check failed: No replica set members match selector "Primary()", Timeout: 30s, Topology Description: <TopologyDescription id: 68709fbd90da362f7e01c3cd, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('mongo_primary', 27017) server_type: RSSecondary, rtt: 0.020432848717291358>]>
ERROR:root:Error enforcing retention policy: No replica set members match selector "Primary()", Timeout: 30s, Topology Description: <TopologyDescription id: 68709fbd90da362f7e01c3cd, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('mongo_primary', 27017) server_type: RSSecondary, rtt: 0.020432848717291358>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
ERROR:root:Database health check failed: No replica set members match selector "Primary()", Timeout: 30s, Topology Description: <TopologyDescription id: 68709fbd90da362f7e01c3cd, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('mongo_primary', 27017) server_type: RSSecondary, rtt: 0.02093841537666758>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
INFO:root:Running periodic database synchronization...
ERROR:root:Error enforcing retention policy: No replica set members match selector "Primary()", Timeout: 30s, Topology Description: <TopologyDescription id: 68709fbd90da362f7e01c3cd, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('mongo_primary', 27017) server_type: RSSecondary, rtt: 0.020163962520513338>]>
ERROR:root:Database health check failed: No replica set members match selector "Primary()", Timeout: 30s, Topology Description: <TopologyDescription id: 68709fbd90da362f7e01c3cd, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('mongo_primary', 27017) server_type: RSSecondary, rtt: 0.016511396465750356>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
ERROR:root:Database health check failed: No replica set members match selector "Primary()", Timeout: 30s, Topology Description: <TopologyDescription id: 68709fbd90da362f7e01c3cd, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('mongo_primary', 27017) server_type: RSSecondary, rtt: 0.01868344722647685>]>
ERROR:root:Error enforcing retention policy: No replica set members match selector "Primary()", Timeout: 30s, Topology Description: <TopologyDescription id: 68709fbd90da362f7e01c3cd, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_backup', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('mongo_primary', 27017) server_type: RSSecondary, rtt: 0.01868344722647685>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
ERROR:root:Database health check failed: Could not reach any servers in [('mongo_primary', 27017)]. Replica set is configured with internal hostnames or IPs?, Timeout: 30s, Topology Description: <TopologyDescription id: 68709fbd90da362f7e01c3cd, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 61] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
INFO:root:Running periodic database synchronization...
ERROR:root:Error enforcing retention policy: Could not reach any servers in [('mongo_primary', 27017)]. Replica set is configured with internal hostnames or IPs?, Timeout: 30s, Topology Description: <TopologyDescription id: 68709fbd90da362f7e01c3cd, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 61] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
ERROR:root:Database health check failed: Could not reach any servers in [('mongo_primary', 27017)]. Replica set is configured with internal hostnames or IPs?, Timeout: 30s, Topology Description: <TopologyDescription id: 68709fbd90da362f7e01c3cd, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 61] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
WARNING:root:Primary database is unavailable. Synchronization skipped.
ERROR:root:Error soft deleting email: Could not reach any servers in [('mongo_primary', 27017)]. Replica set is configured with internal hostnames or IPs?, Timeout: 30s, Topology Description: <TopologyDescription id: 68709fbd90da362f7e01c3cd, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('mongo_primary', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('mongo_primary:27017: [Errno 61] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Connected to primary MongoDB.
INFO:root:Connected to backup MongoDB.
INFO:root:Synchronizing all databases on startup...
INFO:root:Updated primary document with ID 68709a7c08b60dc0317089d9 from backup database.
INFO:root:Synchronized document with ID 6870995dcccfa20cbef47070 to backup database.
INFO:root:Checking database consistency...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Alice's POP3 server running on port 1102
INFO:root:Server running on SMTP port 1026 and POP3 port 1102
INFO:root:Alice's SMTP server running on port 1026
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:2025-07-11 18:42:57.469422 | User: alice@example.com | Action: send_email | Details: To: bob@example.com
INFO:root:Raw email data received:
From: alice@example.com
To: bob@example.com
Encrypted-AES-Key: p4uGdpTA8K20hUvuAnY4iWDRwI+KEWxU+5qQAp/DecblnMAKvbhXtB6eEowAYEKThKVnotDVNZszPvYkMphAROlYEILMnOKTmXuRH6VPH5yMMN7lDwgj0pFVA89a5D0Nb0vkuMnQPtRVEUZl2/kDGjVIO9vvtILGTqtDquMOBohO2MY3sQI3zl2JgE5SWJvSVXcKL0RFdn608msQKVPe5wdPiO/Pa7+Oi/yRbuA2fmSOLxGQy8xw3h6UP++SDK50F+w53oxh+VnTtkOKTKy3vycEIyfjAzZoJ0X0dviHMOeL+U4e8uDthFtj6ySn6dGXo2dwnTP9EDw9+93R0DiNkQ==
IV: ukNb22jEMrLbeTgWWXfgtA==
Message: zEXcEv0Yh4St3w74v5XF4LHYwg62vTqDchjSUAF8xFM=

INFO:root:Message stored in primary database.
INFO:root:Message stored in backup database.
INFO:root:Message stored for recipients: ['bob@example.com']
INFO:root:Received POP3 request for: bob@example.com
INFO:root:Retrieved 2 messages from primary database for recipient: bob@example.com
INFO:root:Sent message to bob@example.com
INFO:root:Sent message to bob@example.com
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Email 68715b3123ba60fd55333846 permanently deleted due to retention policy.
INFO:root:Email 68715b3123ba60fd55333846 permanently deleted due to retention policy.
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:email 68715b298595cc995600a14c deleted from primary database.
INFO:root:email 68715b298595cc995600a14c deleted from backup database.
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
ERROR:root:Error handling POP3 client: '8709a707aafe02d6b564e74' is not a valid ObjectId, it must be a 12-byte input or a 24-character hex string
INFO:root:Running periodic database synchronization...
INFO:root:email 6870995dcccfa20cbef47070 deleted from primary database.
INFO:root:email 6870995dcccfa20cbef47070 deleted from backup database.
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:2025-07-11 18:48:17.336782 | User: alice@example.com | Action: send_email | Details: To: bob@example.com
INFO:root:Raw email data received:
From: alice@example.com
To: bob@example.com
Encrypted-AES-Key: SttRD9PXpcBrndxhN3UOJ0YtDJWws1gsMa2zWV87grB0iVuMu60k4TL6H20PU/Kr6pt7eQslsKvMnloKqbhtTjfnSlk3gIx4OlQ4C7r+pOSdwVpjvZJ3siw0HglQiMgg6/oq/uCv4BChJcGp0qvllr2RQb0jvYmcYcsghuvWHdffqoe9HW5t74xaf38AwAt+/ISNMdM+SGRGoTep6eFmR7RUdOEUUwCd5JQXv7pChwdmX/RnTinx7Puy25mMFIenVTH1zKObvP+ddA6JNnlG167QN2KEXp8pRUtERy/hMax2VoKl2NeIh40juacNuY06yOUDxTN2DfOOy6sUu49LPA==
IV: 9vmQ7Wd/6KeLfk/0hyN19g==
Message: N8asPlm1KHAoxMblMsZlwmYcdDHfvZ2iLW4Ge5CTJmo=

INFO:root:Message stored in primary database.
INFO:root:Message stored in backup database.
INFO:root:Message stored for recipients: ['bob@example.com']
INFO:root:Running periodic database synchronization...
INFO:root:Received POP3 request for: bob@example.com
INFO:root:Retrieved 1 messages from primary database for recipient: bob@example.com
INFO:root:Sent message to bob@example.com
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Received POP3 request for: alice@example.com
WARNING:root:No messages found for recipient: alice@example.com in primary database.
WARNING:root:No messages found for recipient: alice@example.com in backup database.
WARNING:root:No messages found for recipient: alice@example.com
INFO:root:Running periodic database synchronization...
INFO:root:email 68715c7123ba60fd55333847 deleted from primary database.
INFO:root:email 68715c7123ba60fd55333847 deleted from backup database.
INFO:root:2025-07-11 18:49:48.530221 | User: alice@example.com | Action: send_email | Details: To: bob@example.com
INFO:root:2025-07-11 18:49:53.166307 | User: alice@example.com | Action: send_email | Details: To: bob@example.com
INFO:root:Raw email data received:
From: alice@example.com
To: bob@example.com
Encrypted-AES-Key: QBqFyNyFqDQakfuQBGggfJm22UlJLjmQCNc0M2WNPGSXVG8iLo54oIxxTYvtNbMkYOHAF8boHGQi4E/JjDOT99gVk/hgIUTHLRnDZpIwwCrfm89nju3pCvo6nzBXxHRteHp6+KISp46u3hHEOOQT7rC8hpBRPocKiqwKpLH/EoB64/RlIvx4Id9s8t/SAtNNxs3xklx1okZe5XrJ40r3TPwKw8zvkwq+coSuQXfH2d97wfF8QSbxq12YmL+sRNKJizmegxSYg3AXexNpWPb/15bDxusp7S8TECiDQwasrbqWBzrjFFdbKZRp79ZEdm5rYGSJaapUWDxlNKFFpC+/Vw==
IV: EwOyPsMCH/2tNe2KKzxL8w==
Message: RbIFT+2LYEGRTgpwjk3CZqq1cHn8bjQrdsP5uK4sOxg=

INFO:root:Message stored in primary database.
INFO:root:Message stored in backup database.
INFO:root:Message stored for recipients: ['bob@example.com']
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Raw email data received:
From: bob@example.com
To: alice@example.com
Encrypted-AES-Key: J7icPUTC15aJMouFqc2EkC1yO0LxhpKZRLlqRtLcGxsbjUr2PKC6A16NK91tW0tsehGN0VEbx0H11J9lZlFofHjVE3ONU1rjaT74WY2JAjgIRIH2Gd+a0rKjREPk2GnrCbF7LfaHvlKGuefVAffMO7iYFHEiVaZ+UFmyTOosgiPKIR8iJ1Azv+MxZWwaCHAQxJw/e/4H1mQnGsF714i/IDoYqGagmIMKIjcvOh7QbZeKkAVqHgpEFWbD0RbD8bDCi9Y4ohZ/IbtafhBaiCADMwQz3zgJY9Rix9vPDy4so+iuvA+duSDG2H2U16lBrHMRzH37f+B9THoVCzSI6XEMLA==
IV: IQCQDHJxhgbNuJVIUFdmEA==
Message: nlCp3aCO2uw/d/tdJ+vX1BSdfBwzzHstChLekPXza38=

INFO:root:Message stored in primary database.
INFO:root:Message stored in backup database.
INFO:root:Message stored for recipients: ['alice@example.com']
INFO:root:Received POP3 request for: alice@example.com
INFO:root:Retrieved 1 messages from primary database for recipient: alice@example.com
INFO:root:Sent message to alice@example.com
INFO:root:Received POP3 request for: bob@example.com
INFO:root:Retrieved 1 messages from primary database for recipient: bob@example.com
INFO:root:Sent message to bob@example.com
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Connected to primary MongoDB.
INFO:root:Connected to backup MongoDB.
INFO:root:Synchronizing all databases on startup...
INFO:root:Checking database consistency...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Alice's SMTP server running on port 1026
INFO:root:Alice's POP3 server running on port 1102
INFO:root:Server running on SMTP port 1026 and POP3 port 1102
INFO:root:2025-07-11 19:13:01.523145 | User: alice@example.com | Action: send_email | Details: To: bob@example.com
INFO:root:Raw email data received:
From: alice@example.com
To: bob@example.com
Encrypted-AES-Key: iSxTEz4EXDljfGF35BTbbFu3E9bAoJ/15flm+LVEzqdmbLoClyPfihkt58GvoSfii/rxKQs+Y5HIGHIhiUbirSCfguseaf9Mf0X2Dbk4EoBY0Ks/JQsdRXL+/m+AM9f4EFeRGwM/ZDKieWlhGD+orO9D4vv6aEd97A09pJJJ8/UpqrEinNm2OHcFTP34vtSE1Dh8QnER9mUoUsTJgdw3lBRNfxvXfgl36znWrhlzBDrsgSJdJD4JsPpYkwvkn3aRlB8NEnCfR0LhwrfMf2AOFP8dnFOb4bPvW8Il78bkPS8RjNSYDbHFJud/ijXMbKsPseTi1fbk4esPigpg75pnbg==
IV: 0m4tLHViA4YcLwQ6n234tg==
Message: +6moat3QxkmAaLriQ2x5nWQeKnNz9GF0osu0Ldjobu8=

INFO:root:Message stored in primary database.
INFO:root:Message stored in backup database.
INFO:root:Message stored for recipients: ['bob@example.com']
INFO:root:Received POP3 request for: bob@example.com
INFO:root:Retrieved 2 messages from primary database for recipient: bob@example.com
INFO:root:Sent message to bob@example.com
INFO:root:Sent message to bob@example.com
INFO:root:Running periodic database synchronization...
INFO:root:2025-07-11 19:13:37.779697 | User: bob@example.com | Action: EXPORT | Details: User exported their data
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Received POP3 request for: alice@example.com
INFO:root:Retrieved 2 messages from primary database for recipient: alice@example.com
INFO:root:Sent message to alice@example.com
INFO:root:Sent message to alice@example.com
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Email 6871623d59ffdfaf94f8c359 marked for retention until 2025-08-20 19:33:19.085748.
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Email 6871623d59ffdfaf94f8c359 soft deleted in primary database.
INFO:root:Email 6871623d59ffdfaf94f8c359 soft deleted in backup database.
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:2025-07-11 19:36:16.717512 | User: alice@example.com | Action: EXPORT | Details: User exported their data
INFO:root:Running periodic database synchronization...
INFO:root:2025-07-11 19:36:34.674417 | User: alice@example.com | Action: EXPORT | Details: User exported their data
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Received POP3 request for: bob@example.com
INFO:root:Retrieved 1 messages from primary database for recipient: bob@example.com
INFO:root:Sent message to bob@example.com
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Email 68715cd723ba60fd55333849 soft deleted in primary database.
INFO:root:Email 68715cd723ba60fd55333849 soft deleted in backup database.
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Email 68716239ad3202e6f887da68 marked for retention until 2025-08-10 19:41:08.870102.
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Email 68715cd123ba60fd55333848 soft deleted in primary database.
INFO:root:Email 68715cd123ba60fd55333848 soft deleted in backup database.
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Received POP3 request for: bob@example.com
WARNING:root:No messages found for recipient: bob@example.com in primary database.
WARNING:root:No messages found for recipient: bob@example.com in backup database.
WARNING:root:No messages found for recipient: bob@example.com
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:2025-07-11 19:53:32.166889 | User: alice@example.com | Action: send_email | Details: To: bob@example.com
INFO:root:Raw email data received:
From: bob@example.com
To: alice@example.com
Encrypted-AES-Key: Yxzc3736d7nHle5u69EufgXOcVSMKUxY3YwtEwFIa4IFVRhVM6GgjrKc02j1PD2jX5R2K8Y/uq1VHNu1I4KAu0HDJ7zL8hzLZsmmTuYR/82Nbf54i82VwNn+j48gqtH3WHyfiVzHGWmg5IMuSz4nQaHOB3pqQIr2nOryvRmeur3OBksj6DQNnCtaERFf2vpQcJtgw8ejdzEXF1M6j4n6pHIPpRDfYDBQRbiKj5Sq5iMaMApTiJAyu0Va4AE0IR7vfjBxODpssKFd79zDSNIH1vxA/Lhk7w3bloZBfy1p36fp6JRUheTjL8LBO0i23eBT9JbH7ExiSj2SzLe3WDojpQ==
IV: IJVvmU2XWd3wx/gtBCjhaA==
Message: zYBEnI23GX899it+mtrXMBvkdtbpJQbCfROwna7qRlg=

INFO:root:Message stored in primary database.
INFO:root:Message stored in backup database.
INFO:root:Message stored for recipients: ['alice@example.com']
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Connected to primary MongoDB.
INFO:root:Connected to backup MongoDB.
INFO:root:Synchronizing all databases on startup...
INFO:root:Checking database consistency...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Server running on SMTP port 1026 and POP3 port 1102
INFO:root:Alice's POP3 server running on port 1102
INFO:root:Alice's SMTP server running on port 1026
INFO:root:2025-07-11 20:04:37.698728 | User: alice@example.com | Action: send_email | Details: To: bob@example.com
INFO:root:Raw email data received:
From: bob@example.com
To: alice@example.com
Encrypted-AES-Key: NGq8n5nPnNuwBTO9T+sOSu3tU5a3tr/8dWJtsXgKdXPCq2O/I5mp0Ywz2Vd13GNHw+mySDDyTnLB/UT+exkeviaukkjyGSYrm0eYeHVJhjumSyCBdZkjDQcE6y0LkNel5lqIU98AWThVgk/9we/2xShyi7fgrwIdutuEyg1cLq9woaiYyxFeWY1bVHPXORbAkQEY75rrzZ7GHWEpaENZqS8Mlr1TeKl6jlNspPrxJ6JzgteA6YV2EjASTARv+yW1AqUaj0lbe2I2e0B4A4GMmAntbT6Hf05dU9F1n8mdd7BTYHPnyDxFrjZnB7WeMbWir4VQv7ZVUa2FOdRfsZUpRg==
IV: sPc+gD9qcpQIEKFf/1NwvA==
Message: pS6QCvGwo6ZibfhitzGSJddRL2R/2AmDBCxTCJeQjx8=

INFO:root:Message stored in primary database.
INFO:root:Message stored in backup database.
INFO:root:Message stored for recipients: ['alice@example.com']
INFO:root:Received POP3 request for: alice@example.com
INFO:root:Retrieved 3 messages from primary database for recipient: alice@example.com
INFO:root:Sent message to alice@example.com
INFO:root:Sent message to alice@example.com
INFO:root:Sent message to alice@example.com
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Connected to primary MongoDB.
INFO:root:Connected to backup MongoDB.
INFO:root:Synchronizing all databases on startup...
INFO:root:Checking database consistency...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Server running on SMTP port 1026 and POP3 port 1102
INFO:root:Alice's POP3 server running on port 1102
INFO:root:Alice's SMTP server running on port 1026
INFO:root:2025-07-11 20:20:01.959365 | User: alice@example.com | Action: send_email | Details: To: bob@example.com
INFO:root:Raw email data received:
From: alice@example.com
To: bob@example.com
Encrypted-AES-Key: DYq4J5GKblqSyIcze2gTjIUAJ+kzvHcr1icXbg3Mencf/wBMIgl2XW2X+NGoNyB+Q+4Rrk9YS7DK/O8HyYPiB0erOozb2BIxdw7UKx1yDltJnXHbBS9owRa9aJgoGUeKhD3sqsOFzHk8iRqwQL6VXiLYxN+WTeutKy2xkXtFDw7NLFilpIwYzF6Bwfm1IPXzmbQ9LqOoCG9dJHo/f22JIQwEUMQNWt9mRZs7/qOUbVXiLrOiuop0du6APPFC/IdwQPkYSlL7bxmJHH58PYB4QXZEy8NuWYa6+LUIe54E5Rgjo57hWXU97LwjJ33t84N1lzChmwQ9VZc1nNb/dH1sNw==
IV: zYq+LFGQjet0LUpgc+3VQw==
Message: 4Uelhm9gEOGWeM8lepPiK5ZsbrPpv9fzMNawVuze6wM=

INFO:root:Message stored in primary database.
INFO:root:Message stored in backup database.
INFO:root:Message stored for recipients: ['bob@example.com']
INFO:root:Running periodic database synchronization...
INFO:root:Received POP3 request for: bob@example.com
INFO:root:Retrieved 3 messages from primary database for recipient: bob@example.com
INFO:root:Sent message to bob@example.com
INFO:root:Sent message to bob@example.com
INFO:root:Sent message to bob@example.com
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Connected to primary MongoDB.
INFO:root:Connected to backup MongoDB.
INFO:root:Synchronizing all databases on startup...
INFO:root:Checking database consistency...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Server running on SMTP port 1026 and POP3 port 1102
INFO:root:Alice's SMTP server running on port 1026
INFO:root:Alice's POP3 server running on port 1102
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:2025-07-12 20:31:41.573398 | User: alice@example.com | Action: send_email | Details: To: bob@example.com
INFO:root:Raw email data received:
From: alice@example.com
To: bob@example.com
Encrypted-AES-Key: B7IR5FTBM6yOurmZpiZVkpzlG5DFVE0uoJdqInYhlyiMsOVq8AelmA09NhnTV3Mov4wKgPiez/dTFk7/MIyPUHULl7WlXxtvWvJN0GZz9pTaZpTdxNLcSLeZo1XD2hMN9tBhzlP4yYH5AOt7O9eua6f7kZ9pc9E01HIusrqj3/hQV0zAv3yqAYuZUIBqjFlASb0tB+8g0vL7Sp9hkGmOeZnDFUPP9drJrHphbNnriXkn2sdoTvBv7H69Cf+xR+CsvZtUXyLaB5VT6a4+4+Ewq6YfHB3oT5Xvc9wAcuh2c2bGZsBiuKQS8FQHH2OT5JqgDsLZPqs1dMtQt7exOhKl6g==
IV: lRKeJ2vDR7C31Zz4JyY+NQ==
Message: TaIgNmadwBEIc84zoFdsqaEfF8EeT7uIuto2rhUZYRg=

9e00fe240ede1d92eda3e8c6deb9a3cd2caa76855807bd60b2681d1bfffaca23
INFO:root:HMAC verification succeeded.
INFO:root:Message stored in primary database.
INFO:root:Message stored in backup database.
INFO:root:Message stored for recipients: ['bob@example.com']
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
WARNING:root:HMAC verification failed for POP3 command.
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:2025-07-12 20:38:00.791454 | User: alice@example.com | Action: send_email | Details: To: bob@example.com
INFO:root:Raw email data received:
From: alice@example.com
To: bob@example.com
Encrypted-AES-Key: WLe0X9MQ46uh8sHrJT8+Hgxhx3WJonvyl+iMCBt/CPOMJ/17+QwTWLtJEsHBsXG0h7x6Fwj1WpcPkr6iJEgKYNkxLQ8cz8A0fVc2z6cYTKxq6xUs5v/fnxBTAosUBuSIBEWYsW5cl9qGP9LgS4cu7E8SWU/l0A9n/4eCCe5EThEZc+4dpxVei7ojcnNVeFivqimTvPBEEUUpQIcsEiiZdg1a+EmYVHro+CjSrkEW45kQmcwoIRzUhzw/8J3qX0LeT7h2oi71fygl9NjIHXC8ovgkONoB2ajaLjF+JI8MJBXvFZUs5hMCcMxk+FQhRubfXkNjhB6PNlLF4Eiq1E8GEA==
IV: Q/OVOdJxdYACmQFNiu810w==
Message: dQu3bnNZWmzB9YxLarVaAIxCKI9GKI0cQ1J+e4zGTQ0=

a326521d73db92cc3af560ed8703602813bd200fbdaa0a9b02a4af0f4769c5aa
INFO:root:HMAC verification succeeded.
INFO:root:Message stored in primary database.
INFO:root:Message stored in backup database.
INFO:root:Message stored for recipients: ['bob@example.com']
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Connected to primary MongoDB.
INFO:root:Connected to backup MongoDB.
INFO:root:Synchronizing all databases on startup...
INFO:root:Checking database consistency...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Alice's POP3 server running on port 1102
INFO:root:Alice's SMTP server running on port 1026
INFO:root:Server running on SMTP port 1026 and POP3 port 1102
INFO:root:2025-07-12 20:41:52.075962 | User: alice@example.com | Action: send_email | Details: To: bob@example.com
INFO:root:Raw email data received:
From: bob@example.com
To: alice@example.com
Encrypted-AES-Key: r36cDm0SjNHrIeqz+EjkM8DxQLLkp1Y7d2IkzLvidTn3tQhffGTlS+mYKYATqY2ffCHFTo7m/qF6ClMPS3V6DcPOvyjyEgrGEM4BAqI5xDfUWN/7EGnLyrqv+RSjNgWd59cEWDEJeD4I82dIZPc1exO0fiGQuRcJJHv9G5n3zlVHbwB2Pwy7ZzVB93faNWIe/x2muiQFqPXjyjqNZt6mFPztGVE+P/9a4eODA9zWoqxrLvUziK/1pLnSIVjOvDkcGctMhu0q813P4+mn32E542OTyEqSo99vqxkiieSKCxAB8NdPssNb4VIL1okgKCozPfD4BSS+ZgiAtx+dC6naIQ==
IV: 1GKqEXYy/xTmOQSNFCPHBg==
Message: 0k2YvYt8o+nkbeDzA9fWqOiALg8hye3/KZY0GMOO/Cw=

3d56e577c85db6e5a46b39742d3baf4889deb6dee844de3b7cc890d57b251769
INFO:root:HMAC verification succeeded.
INFO:root:Message stored in primary database.
INFO:root:Message stored in backup database.
INFO:root:Message stored for recipients: ['alice@example.com']
WARNING:root:HMAC verification failed for POP3 command.
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Connected to primary MongoDB.
INFO:root:Connected to backup MongoDB.
INFO:root:Synchronizing all databases on startup...
INFO:root:Checking database consistency...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Alice's POP3 server running on port 1102
INFO:root:Alice's SMTP server running on port 1026
INFO:root:Server running on SMTP port 1026 and POP3 port 1102
INFO:root:2025-07-12 20:47:38.363944 | User: alice@example.com | Action: send_email | Details: To: bob@example.com
INFO:root:Raw email data received:
From: bob@example.com
To: alice@example.com
Encrypted-AES-Key: V1NvxDOV+9rFDJfiGvmMNbQZtCevnFaOOaZHm/460ObcgU05rdwGdhfvjb/LVk/RfcWHbd5tq9SNhauGGquyZuaB7Ma8VeeGILU88PPv7Pc+Z0MHKmpmxiWW19p13qegJNerBmP/WSB+JwX9iBzPOJuYMLUA1AG1Jmi3YcX2ZhCSIkZeao1/QoUW+57NdXywUiGBboXyy6ZMvtzAcrW+HIDY1x5JqhZvBsgMpmAGIRQMQlKwt1U1zz6eXZAZumTRMFrNN5FbkbyoGyCiWgY2nAE+488MAbsQX8riRZWIzZlJWJLAeEKYoWc9qlz7tBimFT/DMV6ujlV2bpI91YMoNA==
IV: 5RLsji8tHMMpZL+x3UxtqQ==
Message: sSdzs3j7JmH2R+UImyXb42wLchSP/yVKha27lAehS/s=

500b768836dce36ba3ef404388184ff96b37ab3840635b4e9eff8cebce0d784e
INFO:root:HMAC verification succeeded.
INFO:root:Message stored in primary database.
INFO:root:Message stored in backup database.
INFO:root:Message stored for recipients: ['alice@example.com']
ERROR:root:Invalid command format received from client.
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Received POP3 request for: alice@example.com
INFO:root:Retrieved 7 messages from primary database for recipient: alice@example.com
INFO:root:Sent message to alice@example.com
INFO:root:Sent message to alice@example.com
INFO:root:Sent message to alice@example.com
INFO:root:Sent message to alice@example.com
INFO:root:Sent message to alice@example.com
INFO:root:Sent message to alice@example.com
INFO:root:Sent message to alice@example.com
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
INFO:root:Email 6872c9eb7a542c87d896dbf4 soft deleted in primary database.
INFO:root:Email 6872c9eb7a542c87d896dbf4 soft deleted in backup database.
INFO:root:Running periodic database synchronization...
INFO:root:email 6872c9eb7a542c87d896dbf4 deleted from primary database.
INFO:root:email 6872c9eb7a542c87d896dbf4 deleted from backup database.
INFO:root:Enforcing retention policy...
INFO:root:Running periodic database synchronization...
ERROR:root:Error handling POP3 client: '7' is not a valid ObjectId, it must be a 12-byte input or a 24-character hex string
INFO:root:Running periodic database synchronization...
INFO:root:Enforcing retention policy...
